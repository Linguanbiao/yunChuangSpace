{"ast":null,"code":"import _defineProperty from \"/Users/linwinwin/Desktop/mysit2/mysite-client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport Mock from 'mockjs';\nimport qs from 'qs'; // 利用 mock 模拟 getBlogs 和 getBlogTypes 请求服务器返回的数据\n\nMock.mock(\"/api/blogtype\", \"get\", {\n  code: 0,\n  msg: \"\",\n  \"data|10-20\": [{\n    //随机在 10 到 20 生成\n    \"id|+1\": 1,\n    //自增1\n    name: \"分类@id\",\n    \"articleCount|0-300\": 0,\n    // 随机生成数据\n    \"order|+1\": 1 //自增 1 \n\n  }]\n});\nMock.mock(/^\\/api\\/blog(\\?.+)?$/, \"get\", function (options) {\n  var query = qs.parse(options.url);\n  return Mock.mock({\n    code: 0,\n    msg: \"\",\n    data: _defineProperty({\n      \"total|2000-3000\": 0\n    }, \"rows|\".concat(query.limit || 10), [{\n      id: \"@guid\",\n      title: \"@ctitle\",\n      description: \"@cparagraph(1,10)\",\n      category: {\n        \"id|1-10\": 0,\n        name: \"分类@id\"\n      },\n      \"scanCount|0-3000\": 0,\n      \"commentCount|0-3000\": 0,\n      // \"thumb|1\": [Mock.Random.image(\"300x250\", \"#000\", \"#fff\", \"Random Image\"), null],\n      \"thumb|1\": [\"@image(300x250, #000, @color, @natural)\"],\n      createDate: \"@date('T')\"\n    }])\n  });\n});\nMock.mock(/^\\/api\\/blog\\/[^/]+$/, \"get\", {\n  code: 0,\n  msg: \"\",\n  data: {\n    id: \"@guid\",\n    title: \"前端常见跨域解决方案（全）\",\n    category: {\n      \"id|1-10\": 0,\n      name: \"分类@id\"\n    },\n    description: \"@cparagraph(1, 10)\",\n    \"scanNumber|0-10000\": 0,\n    \"commentNumber|0-100\": 0,\n    createDate: \"@date('T')\",\n    toc: [{\n      name: \"什么是跨域\",\n      anchor: 'article-md-title-1'\n    }, {\n      name: \"常见的跨域场景\",\n      anchor: 'article-md-title-2'\n    }, {\n      name: \"9种跨域解决方法\",\n      anchor: 'article-md-title-3',\n      childrenList: [{\n        name: \"JSON跨域\",\n        anchor: \"article-md-title-4\"\n      }, {\n        name: \"跨域资源共享(CORS)\",\n        anchor: \"article-md-title-5\"\n      }, {\n        name: \"nginx代理跨域\",\n        anchor: \"article-md-title-6\"\n      }, {\n        name: \"nodejs中间件代理跨域\",\n        anchor: \"article-md-title-7\"\n      }, {\n        name: \"document.domain+iframe跨域\",\n        anchor: \"article-md-title-8\"\n      }, {\n        name: \"Location.hash+iframe跨域\",\n        anchor: \"article-md-title-9\"\n      }, {\n        name: \"window.name+iframe跨域\",\n        anchor: \"article-md-title-10\"\n      }, {\n        name: \"postMessage跨域\",\n        anchor: \"article-md-title-11\"\n      }, {\n        name: \"WebSocket协议跨域\",\n        anchor: \"article-md-title-12\"\n      }]\n    }],\n    \"thumb|1\": [Mock.Random.image(\"300x250\", \"#000\", \"#fff\", \"Random Image\"), null],\n    htmlContent: \"<div id=\\\"article_content\\\" class=\\\"article_content clearfix\\\">\\n       \\n                <div id=\\\"content_views\\\" class=\\\"htmledit_views\\\">\\n<div style=\\\"margin-left:0px;\\\"> \\n <div style=\\\"margin-left:0px;\\\"> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h2 style=\\\"margin-left:0px;\\\" id =\\\"article-md-title-1\\\"><a name=\\\"t0\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u4E00\\u3001\\u4EC0\\u4E48\\u662F\\u8DE8\\u57DF\\uFF1F</span></h2> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u5728\\u524D\\u7AEF\\u9886\\u57DF\\u4E2D\\uFF0C\\u8DE8\\u57DF\\u662F\\u6307\\u6D4F\\u89C8\\u5668\\u5141\\u8BB8\\u5411\\u670D\\u52A1\\u5668\\u53D1\\u9001\\u8DE8\\u57DF\\u8BF7\\u6C42\\uFF0C\\u4ECE\\u800C\\u514B\\u670DAjax\\u53EA\\u80FD<strong>\\u540C\\u6E90</strong>\\u4F7F\\u7528\\u7684\\u9650\\u5236\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\"><a name=\\\"t1\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u4EC0\\u4E48\\u662F\\u540C\\u6E90\\u7B56\\u7565\\uFF1F</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003<strong>\\u540C\\u6E90\\u7B56\\u7565</strong>\\u662F\\u4E00\\u79CD\\u7EA6\\u5B9A\\uFF0C\\u7531Netscape\\u516C\\u53F81995\\u5E74\\u5F15\\u5165\\u6D4F\\u89C8\\u5668\\uFF0C\\u5B83\\u662F\\u6D4F\\u89C8\\u5668\\u6700\\u6838\\u5FC3\\u4E5F\\u6700\\u57FA\\u672C\\u7684\\u5B89\\u5168\\u529F\\u80FD\\uFF0C\\u5982\\u679C\\u7F3A\\u5C11\\u4E86\\u540C\\u6E90\\u7B56\\u7565\\uFF0C\\u6D4F\\u89C8\\u5668\\u5F88\\u5BB9\\u6613\\u53D7\\u5230XSS\\u3001CSFR\\u7B49\\u653B\\u51FB\\u3002\\u6240\\u8C13\\u540C\\u6E90\\u662F\\u6307\\\"\\u534F\\u8BAE+\\u57DF\\u540D+\\u7AEF\\u53E3\\\"\\u4E09\\u8005\\u76F8\\u540C\\uFF0C\\u5373\\u4FBF\\u4E24\\u4E2A\\u4E0D\\u540C\\u7684\\u57DF\\u540D\\u6307\\u5411\\u540C\\u4E00\\u4E2Aip\\u5730\\u5740\\uFF0C\\u4E5F\\u975E\\u540C\\u6E90\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u540C\\u6E90\\u7B56\\u7565\\u9650\\u5236\\u4EE5\\u4E0B\\u51E0\\u79CD\\u884C\\u4E3A\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">Cookie\\u3001LocalStorage \\u548C IndexDB \\u65E0\\u6CD5\\u8BFB\\u53D6</span></li><li><span style=\\\"color:#1c1f21;\\\">DOM\\u548CJS\\u5BF9\\u8C61\\u65E0\\u6CD5\\u83B7\\u5F97</span></li><li><span style=\\\"color:#1c1f21;\\\">AJAX \\u8BF7\\u6C42\\u4E0D\\u80FD\\u53D1\\u9001</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h2 style=\\\"margin-left:0px;\\\" id= \\\"article-md-title-2\\\"><a name=\\\"t2\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u4E8C\\u3001\\u5E38\\u89C1\\u7684\\u8DE8\\u57DF\\u573A\\u666F</span></h2> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <div style=\\\"margin-left:0px;\\\"> \\n    <div class=\\\"table-box\\\"><table border=\\\"1\\\" cellspacing=\\\"0\\\"><thead><tr><th style=\\\"border-color:#bbbbbb #dddddd #dddddd;text-align:left;\\\"><span style=\\\"color:#1c1f21;\\\">URL</span></th><th style=\\\"border-color:#bbbbbb #dddddd #dddddd;text-align:left;\\\"><span style=\\\"color:#1c1f21;\\\">\\u8BF4\\u660E</span></th><th style=\\\"border-color:#bbbbbb #dddddd #dddddd;text-align:left;\\\"><span style=\\\"color:#1c1f21;\\\">\\u662F\\u5426\\u5141\\u8BB8\\u901A\\u4FE1</span></th></tr></thead><tbody><tr><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\"><a href=\\\"http://www.domain.com/\\\">http://www.domain.com/</a><span style=\\\"color:#ff0000;\\\">a.js</span><br><a href=\\\"http://www.domain.com/\\\">http://www.domain.com/</a><span style=\\\"color:#ff0000;\\\">b.js</span><br><a href=\\\"http://www.domain.com/\\\">http://www.domain.com/</a><span style=\\\"color:#ff0000;\\\">lab/c.js</span></span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u540C\\u4E00\\u57DF\\u540D\\uFF0C\\u4E0D\\u540C\\u6587\\u4EF6\\u6216\\u8DEF\\u5F84</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u5141\\u8BB8</span></td></tr><tr><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\"><a href=\\\"http://www.domain.com/\\\">http://www.domain.com</a>:<span style=\\\"color:#ff0000;\\\">8000</span>/a.js<br><a href=\\\"http://www.domain.com/b.js\\\">http://www.domain.com/b.js</a></span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u540C\\u4E00\\u57DF\\u540D\\uFF0C\\u4E0D\\u540C\\u7AEF\\u53E3</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u5141\\u8BB8</span></td></tr><tr><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\"><span style=\\\"color:#ff0000;\\\">http</span>://www.domain.com/a.js<br><span style=\\\"color:#ff0000;\\\">https</span>://www.domain.com/b.js</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u540C\\u4E00\\u57DF\\u540D\\uFF0C\\u4E0D\\u540C\\u534F\\u8BAE</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u5141\\u8BB8</span></td></tr><tr><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">http://<span style=\\\"color:#ff0000;\\\">www.domain.com</span>/a.js<br> http://<span style=\\\"color:#ff0000;\\\">192.168.4.12</span>/b.js</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u57DF\\u540D\\u548C\\u57DF\\u540D\\u5BF9\\u5E94\\u76F8\\u540Cip</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u5141\\u8BB8</span></td></tr><tr><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">http://<span style=\\\"color:#ff0000;\\\">www.domain.com</span>/a.js<br> http://<span style=\\\"color:#ff0000;\\\">x.domain.com</span>/b.js<br> http://<span style=\\\"color:#ff0000;\\\">domain.com</span>/c.js</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E3B\\u57DF\\u76F8\\u540C\\uFF0C\\u5B50\\u57DF\\u4E0D\\u540C</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u5141\\u8BB8</span></td></tr><tr><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">http://<span style=\\\"color:#ff0000;\\\">www.domain1.com</span>/a.js<br> http://<span style=\\\"color:#ff0000;\\\">www.domain2.com</span>/b.js</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u540C\\u57DF\\u540D</span></td><td style=\\\"border-color:#dddddd;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u5141\\u8BB8</span></td></tr></tbody></table></div>\\n   </div> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h2 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-3\\\"><a name=\\\"t3\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u4E09\\u30019\\u79CD\\u8DE8\\u57DF\\u89E3\\u51B3\\u65B9\\u6848</span></h2> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-4\\\"><a name=\\\"t4\\\"></a><span style=\\\"color:#1c1f21;\\\">1\\u3001JSONP\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003<strong>jsonp</strong>\\u7684\\u539F\\u7406\\u5C31\\u662F\\u5229\\u7528<code>&lt;script&gt;</code>\\u6807\\u7B7E\\u6CA1\\u6709\\u8DE8\\u57DF\\u9650\\u5236\\uFF0C\\u901A\\u8FC7<code>&lt;script&gt;</code>\\u6807\\u7B7Esrc\\u5C5E\\u6027\\uFF0C\\u53D1\\u9001\\u5E26\\u6709callback\\u53C2\\u6570\\u7684GET\\u8BF7\\u6C42\\uFF0C\\u670D\\u52A1\\u7AEF\\u5C06\\u63A5\\u53E3\\u8FD4\\u56DE\\u6570\\u636E\\u62FC\\u51D1\\u5230callback\\u51FD\\u6570\\u4E2D\\uFF0C\\u8FD4\\u56DE\\u7ED9\\u6D4F\\u89C8\\u5668\\uFF0C\\u6D4F\\u89C8\\u5668\\u89E3\\u6790\\u6267\\u884C\\uFF0C\\u4ECE\\u800C\\u524D\\u7AEF\\u62FF\\u5230callback\\u51FD\\u6570\\u8FD4\\u56DE\\u7684\\u6570\\u636E\\u3002<br><br> 1\\uFF09\\u539F\\u751FJS\\u5B9E\\u73B0\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:816px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> script = <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-title function_\\\">createElement</span>(<span class=\\\"hljs-string\\\">'script'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    script.<span class=\\\"hljs-property\\\">type</span> = <span class=\\\"hljs-string\\\">'text/javascript'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u4F20\\u53C2\\u4E00\\u4E2A\\u56DE\\u8C03\\u51FD\\u6570\\u540D\\u7ED9\\u540E\\u7AEF\\uFF0C\\u65B9\\u4FBF\\u540E\\u7AEF\\u8FD4\\u56DE\\u65F6\\u6267\\u884C\\u8FD9\\u4E2A\\u5728\\u524D\\u7AEF\\u5B9A\\u4E49\\u7684\\u56DE\\u8C03\\u51FD\\u6570</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    script.<span class=\\\"hljs-property\\\">src</span> = <span class=\\\"hljs-string\\\">'http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-property\\\">head</span>.<span class=\\\"hljs-title function_\\\">appendChild</span>(script);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u56DE\\u8C03\\u6267\\u884C\\u51FD\\u6570</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">function</span> <span class=\\\"hljs-title function_\\\">handleCallback</span>(<span class=\\\"hljs-params\\\">res</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-title function_\\\">alert</span>(<span class=\\\"hljs-title class_\\\">JSON</span>.<span class=\\\"hljs-title function_\\\">stringify</span>(res));</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u670D\\u52A1\\u7AEF\\u8FD4\\u56DE\\u5982\\u4E0B\\uFF08\\u8FD4\\u56DE\\u65F6\\u5373\\u6267\\u884C\\u5168\\u5C40\\u51FD\\u6570\\uFF09\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><span class=\\\"hljs-title function_\\\">handleCallback</span>({<span class=\\\"hljs-string\\\">\\\"success\\\"</span>: <span class=\\\"hljs-literal\\\">true</span>, <span class=\\\"hljs-string\\\">\\\"user\\\"</span>: <span class=\\\"hljs-string\\\">\\\"admin\\\"</span>})\\n</code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">2\\uFF09jquery Ajax\\u5B9E\\u73B0\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-rust\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">$.<span class=\\\"hljs-title function_ invoke__\\\">ajax</span>({</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    url: <span class=\\\"hljs-symbol\\\">'http</span>:<span class=\\\"hljs-comment\\\">//www.domain2.com:8080/login',</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">type</span>: <span class=\\\"hljs-symbol\\\">'get</span>',</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    dataType: <span class=\\\"hljs-symbol\\\">'jsonp</span>',  <span class=\\\"hljs-comment\\\">// \\u8BF7\\u6C42\\u65B9\\u5F0F\\u4E3Ajsonp</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    jsonpCallback: <span class=\\\"hljs-string\\\">\\\"handleCallback\\\"</span>,  <span class=\\\"hljs-comment\\\">// \\u81EA\\u5B9A\\u4E49\\u56DE\\u8C03\\u51FD\\u6570\\u540D</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    data: {}</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">3\\uFF09Vue axios\\u5B9E\\u73B0\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">$http</span> = axios;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">$http</span>.<span class=\\\"hljs-title function_\\\">jsonp</span>(<span class=\\\"hljs-string\\\">'http://www.domain2.com:8080/login'</span>, {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-attr\\\">params</span>: {},</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-attr\\\">jsonp</span>: <span class=\\\"hljs-string\\\">'handleCallback'</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">}).<span class=\\\"hljs-title function_\\\">then</span>(<span class=\\\"hljs-function\\\">(<span class=\\\"hljs-params\\\">res</span>) =&gt;</span> {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(res); </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">})</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u540E\\u7AEFnode.js\\u4EE3\\u7801\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> querystring = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'querystring'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> http = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'http'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> server = http.<span class=\\\"hljs-title function_\\\">createServer</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">server.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'request'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">req, res</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> params = querystring.<span class=\\\"hljs-title function_\\\">parse</span>(req.<span class=\\\"hljs-property\\\">url</span>.<span class=\\\"hljs-title function_\\\">split</span>(<span class=\\\"hljs-string\\\">'?'</span>)[<span class=\\\"hljs-number\\\">1</span>]);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> fn = params.<span class=\\\"hljs-property\\\">callback</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// jsonp\\u8FD4\\u56DE\\u8BBE\\u7F6E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    res.<span class=\\\"hljs-title function_\\\">writeHead</span>(<span class=\\\"hljs-number\\\">200</span>, { <span class=\\\"hljs-string\\\">'Content-Type'</span>: <span class=\\\"hljs-string\\\">'text/javascript'</span> });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    res.<span class=\\\"hljs-title function_\\\">write</span>(fn + <span class=\\\"hljs-string\\\">'('</span> + <span class=\\\"hljs-title class_\\\">JSON</span>.<span class=\\\"hljs-title function_\\\">stringify</span>(params) + <span class=\\\"hljs-string\\\">')'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    res.<span class=\\\"hljs-title function_\\\">end</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">server.<span class=\\\"hljs-title function_\\\">listen</span>(<span class=\\\"hljs-string\\\">'8080'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"17\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'Server is running at port 8080...'</span>);</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <blockquote> \\n    <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">jsonp\\u7684\\u7F3A\\u70B9\\uFF1A\\u53EA\\u80FD\\u53D1\\u9001get\\u4E00\\u79CD\\u8BF7\\u6C42\\u3002</span></p> \\n   </blockquote> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-5\\\"><a name=\\\"t5\\\"></a><span style=\\\"color:#1c1f21;\\\">2\\u3001\\u8DE8\\u57DF\\u8D44\\u6E90\\u5171\\u4EAB\\uFF08CORS\\uFF09</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003<strong>CORS</strong>\\u662F\\u4E00\\u4E2AW3C\\u6807\\u51C6\\uFF0C\\u5168\\u79F0\\u662F\\\"\\u8DE8\\u57DF\\u8D44\\u6E90\\u5171\\u4EAB\\\"\\uFF08Cross-origin resource sharing\\uFF09\\u3002<br> \\u5B83\\u5141\\u8BB8\\u6D4F\\u89C8\\u5668\\u5411\\u8DE8\\u6E90\\u670D\\u52A1\\u5668\\uFF0C\\u53D1\\u51FAXMLHttpRequest\\u8BF7\\u6C42\\uFF0C\\u4ECE\\u800C\\u514B\\u670D\\u4E86AJAX\\u53EA\\u80FD\\u540C\\u6E90\\u4F7F\\u7528\\u7684\\u9650\\u5236\\u3002<br> CORS\\u9700\\u8981\\u6D4F\\u89C8\\u5668\\u548C\\u670D\\u52A1\\u5668\\u540C\\u65F6\\u652F\\u6301\\u3002\\u76EE\\u524D\\uFF0C\\u6240\\u6709\\u6D4F\\u89C8\\u5668\\u90FD\\u652F\\u6301\\u8BE5\\u529F\\u80FD\\uFF0CIE\\u6D4F\\u89C8\\u5668\\u4E0D\\u80FD\\u4F4E\\u4E8EIE10\\u3002<br><br> \\u2003\\u2003\\u6D4F\\u89C8\\u5668\\u5C06CORS\\u8DE8\\u57DF\\u8BF7\\u6C42\\u5206\\u4E3A\\u7B80\\u5355\\u8BF7\\u6C42\\u548C\\u975E\\u7B80\\u5355\\u8BF7\\u6C42\\u3002<br><br> \\u2003\\u2003\\u53EA\\u8981\\u540C\\u65F6\\u6EE1\\u8DB3\\u4E00\\u4E0B\\u4E24\\u4E2A\\u6761\\u4EF6\\uFF0C\\u5C31\\u5C5E\\u4E8E\\u7B80\\u5355\\u8BF7\\u6C42<br><br> (1)\\u4F7F\\u7528\\u4E0B\\u5217\\u65B9\\u6CD5\\u4E4B\\u4E00\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">head</span></li><li><span style=\\\"color:#1c1f21;\\\">get</span></li><li><span style=\\\"color:#1c1f21;\\\">post</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">(2)\\u8BF7\\u6C42\\u7684Heder\\u662F</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">Accept</span></li><li><span style=\\\"color:#1c1f21;\\\">Accept-Language</span></li><li><span style=\\\"color:#1c1f21;\\\">Content-Language</span></li><li><span style=\\\"color:#1c1f21;\\\">Content-Type: \\u53EA\\u9650\\u4E8E\\u4E09\\u4E2A\\u503C\\uFF1Aapplication/x-www-form-urlencoded\\u3001multipart/form-data\\u3001text/plain</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u4E0D\\u540C\\u65F6\\u6EE1\\u8DB3\\u4E0A\\u9762\\u7684\\u4E24\\u4E2A\\u6761\\u4EF6\\uFF0C\\u5C31\\u5C5E\\u4E8E\\u975E\\u7B80\\u5355\\u8BF7\\u6C42\\u3002\\u6D4F\\u89C8\\u5668\\u5BF9\\u8FD9\\u4E24\\u79CD\\u7684\\u5904\\u7406\\uFF0C\\u662F\\u4E0D\\u4E00\\u6837\\u7684\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" ><a name=\\\"t6\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u7B80\\u5355\\u8BF7\\u6C42</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u5BF9\\u4E8E\\u7B80\\u5355\\u8BF7\\u6C42\\uFF0C\\u6D4F\\u89C8\\u5668\\u76F4\\u63A5\\u53D1\\u51FACORS\\u8BF7\\u6C42\\u3002\\u5177\\u4F53\\u6765\\u8BF4\\uFF0C\\u5C31\\u662F\\u5728\\u5934\\u4FE1\\u606F\\u4E4B\\u4E2D\\uFF0C\\u589E\\u52A0\\u4E00\\u4E2AOrigin\\u5B57\\u6BB5\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-sql\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">GET</span> <span class=\\\"hljs-operator\\\">/</span>cors HTTP<span class=\\\"hljs-operator\\\">/</span><span class=\\\"hljs-number\\\">1.1</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Origin: http:<span class=\\\"hljs-operator\\\">/</span><span class=\\\"hljs-operator\\\">/</span>api.bob.com</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Host: api.alice.com</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Accept<span class=\\\"hljs-operator\\\">-</span><span class=\\\"hljs-keyword\\\">Language</span>: en<span class=\\\"hljs-operator\\\">-</span>US</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Connection: keep<span class=\\\"hljs-operator\\\">-</span>alive</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">User</span><span class=\\\"hljs-operator\\\">-</span>Agent: Mozilla<span class=\\\"hljs-operator\\\">/</span><span class=\\\"hljs-number\\\">5.0</span>...</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u4E0A\\u9762\\u7684\\u5934\\u4FE1\\u606F\\u4E2D\\uFF0COrigin\\u5B57\\u6BB5\\u7528\\u6765\\u8BF4\\u660E\\uFF0C\\u672C\\u6B21\\u8BF7\\u6C42\\u6765\\u81EA\\u54EA\\u4E2A\\u6E90\\uFF08\\u534F\\u8BAE + \\u57DF\\u540D + \\u7AEF\\u53E3\\uFF09\\u3002\\u670D\\u52A1\\u5668\\u6839\\u636E\\u8FD9\\u4E2A\\u503C\\uFF0C\\u51B3\\u5B9A\\u662F\\u5426\\u540C\\u610F\\u8FD9\\u6B21\\u8BF7\\u6C42\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p><span style=\\\"color:#1c1f21;\\\">CORS\\u8BF7\\u6C42\\u8BBE\\u7F6E\\u7684\\u54CD\\u5E94\\u5934\\u5B57\\u6BB5\\uFF0C\\u90FD\\u4EE5 Access-Control-\\u5F00\\u5934:</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><strong>1\\uFF09Access-Control-Allow-Origin</strong>\\uFF1A\\u5FC5\\u9009<br><br> \\u2003\\u2003\\u5B83\\u7684\\u503C\\u8981\\u4E48\\u662F\\u8BF7\\u6C42\\u65F6Origin\\u5B57\\u6BB5\\u7684\\u503C\\uFF0C\\u8981\\u4E48\\u662F\\u4E00\\u4E2A*\\uFF0C\\u8868\\u793A\\u63A5\\u53D7\\u4EFB\\u610F\\u57DF\\u540D\\u7684\\u8BF7\\u6C42\\u3002<br><br><strong>2\\uFF09Access-Control-Allow-Credentials</strong>\\uFF1A\\u53EF\\u9009<br><br> \\u2003\\u2003\\u5B83\\u7684\\u503C\\u662F\\u4E00\\u4E2A\\u5E03\\u5C14\\u503C\\uFF0C\\u8868\\u793A\\u662F\\u5426\\u5141\\u8BB8\\u53D1\\u9001Cookie\\u3002\\u9ED8\\u8BA4\\u60C5\\u51B5\\u4E0B\\uFF0CCookie\\u4E0D\\u5305\\u62EC\\u5728CORS\\u8BF7\\u6C42\\u4E4B\\u4E2D\\u3002\\u8BBE\\u4E3Atrue\\uFF0C\\u5373\\u8868\\u793A\\u670D\\u52A1\\u5668\\u660E\\u786E\\u8BB8\\u53EF\\uFF0CCookie\\u53EF\\u4EE5\\u5305\\u542B\\u5728\\u8BF7\\u6C42\\u4E2D\\uFF0C\\u4E00\\u8D77\\u53D1\\u7ED9\\u670D\\u52A1\\u5668\\u3002\\u8FD9\\u4E2A\\u503C\\u4E5F\\u53EA\\u80FD\\u8BBE\\u4E3Atrue\\uFF0C\\u5982\\u679C\\u670D\\u52A1\\u5668\\u4E0D\\u8981\\u6D4F\\u89C8\\u5668\\u53D1\\u9001Cookie\\uFF0C\\u5220\\u9664\\u8BE5\\u5B57\\u6BB5\\u5373\\u53EF\\u3002<br><br><strong>3\\uFF09Access-Control-Expose-Headers</strong>\\uFF1A\\u53EF\\u9009<br><br> \\u2003\\u2003CORS\\u8BF7\\u6C42\\u65F6\\uFF0CXMLHttpRequest\\u5BF9\\u8C61\\u7684getResponseHeader()\\u65B9\\u6CD5\\u53EA\\u80FD\\u62FF\\u52306\\u4E2A\\u57FA\\u672C\\u5B57\\u6BB5\\uFF1ACache-Control\\u3001Content-Language\\u3001Content-Type\\u3001Expires\\u3001Last-Modified\\u3001Pragma\\u3002\\u5982\\u679C\\u60F3\\u62FF\\u5230\\u5176\\u4ED6\\u5B57\\u6BB5\\uFF0C\\u5C31\\u5FC5\\u987B\\u5728Access-Control-Expose-Headers\\u91CC\\u9762\\u6307\\u5B9A\\u3002\\u4E0A\\u9762\\u7684\\u4F8B\\u5B50\\u6307\\u5B9A\\uFF0CgetResponseHeader(\\u2018FooBar\\u2019)\\u53EF\\u4EE5\\u8FD4\\u56DEFooBar\\u5B57\\u6BB5\\u7684\\u503C\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\"><a name=\\\"t7\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u975E\\u7B80\\u5355\\u8BF7\\u6C42</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u975E\\u7B80\\u5355\\u8BF7\\u6C42\\u662F\\u90A3\\u79CD\\u5BF9\\u670D\\u52A1\\u5668\\u6709\\u7279\\u6B8A\\u8981\\u6C42\\u7684\\u8BF7\\u6C42\\uFF0C\\u6BD4\\u5982\\u8BF7\\u6C42\\u65B9\\u6CD5\\u662FPUT\\u6216DELETE\\uFF0C\\u6216\\u8005Content-Type\\u5B57\\u6BB5\\u7684\\u7C7B\\u578B\\u662Fapplication/json\\u3002\\u975E\\u7B80\\u5355\\u8BF7\\u6C42\\u7684CORS\\u8BF7\\u6C42\\uFF0C\\u4F1A\\u5728\\u6B63\\u5F0F\\u901A\\u4FE1\\u4E4B\\u524D\\uFF0C\\u589E\\u52A0\\u4E00\\u6B21HTTP\\u67E5\\u8BE2\\u8BF7\\u6C42\\uFF0C\\u79F0\\u4E3A\\\"\\u9884\\u68C0\\\"\\u8BF7\\u6C42\\uFF08preflight\\uFF09\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p><span style=\\\"color:#1c1f21;\\\">\\u9884\\u68C0\\u8BF7\\u6C42</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u9884\\u68C0\\\"\\u8BF7\\u6C42\\u7528\\u7684\\u8BF7\\u6C42\\u65B9\\u6CD5\\u662FOPTIONS\\uFF0C\\u8868\\u793A\\u8FD9\\u4E2A\\u8BF7\\u6C42\\u662F\\u7528\\u6765\\u8BE2\\u95EE\\u7684\\u3002\\u8BF7\\u6C42\\u5934\\u4FE1\\u606F\\u91CC\\u9762\\uFF0C\\u5173\\u952E\\u5B57\\u6BB5\\u662FOrigin\\uFF0C\\u8868\\u793A\\u8BF7\\u6C42\\u6765\\u81EA\\u54EA\\u4E2A\\u6E90\\u3002\\u9664\\u4E86Origin\\u5B57\\u6BB5\\uFF0C\\\"\\u9884\\u68C0\\\"\\u8BF7\\u6C42\\u7684\\u5934\\u4FE1\\u606F\\u5305\\u62EC\\u4E24\\u4E2A\\u7279\\u6B8A\\u5B57\\u6BB5\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-sql\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">OPTIONS <span class=\\\"hljs-operator\\\">/</span>cors HTTP<span class=\\\"hljs-operator\\\">/</span><span class=\\\"hljs-number\\\">1.1</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Origin: http:<span class=\\\"hljs-operator\\\">/</span><span class=\\\"hljs-operator\\\">/</span>api.bob.com</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Access<span class=\\\"hljs-operator\\\">-</span>Control<span class=\\\"hljs-operator\\\">-</span>Request<span class=\\\"hljs-operator\\\">-</span><span class=\\\"hljs-keyword\\\">Method</span>: PUT</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Access<span class=\\\"hljs-operator\\\">-</span>Control<span class=\\\"hljs-operator\\\">-</span>Request<span class=\\\"hljs-operator\\\">-</span>Headers: X<span class=\\\"hljs-operator\\\">-</span>Custom<span class=\\\"hljs-operator\\\">-</span>Header</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Host: api.alice.com</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Accept<span class=\\\"hljs-operator\\\">-</span><span class=\\\"hljs-keyword\\\">Language</span>: en<span class=\\\"hljs-operator\\\">-</span>US</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">Connection: keep<span class=\\\"hljs-operator\\\">-</span>alive</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">User</span><span class=\\\"hljs-operator\\\">-</span>Agent: Mozilla<span class=\\\"hljs-operator\\\">/</span><span class=\\\"hljs-number\\\">5.0</span>..</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><strong>1\\uFF09Access-Control-Request-Method</strong>\\uFF1A\\u5FC5\\u9009<br><br> \\u2003\\u2003\\u7528\\u6765\\u5217\\u51FA\\u6D4F\\u89C8\\u5668\\u7684CORS\\u8BF7\\u6C42\\u4F1A\\u7528\\u5230\\u54EA\\u4E9BHTTP\\u65B9\\u6CD5\\uFF0C\\u4E0A\\u4F8B\\u662FPUT\\u3002<br><br><strong>2\\uFF09Access-Control-Request-Headers</strong>\\uFF1A\\u53EF\\u9009<br><br> \\u2003\\u2003\\u8BE5\\u5B57\\u6BB5\\u662F\\u4E00\\u4E2A\\u9017\\u53F7\\u5206\\u9694\\u7684\\u5B57\\u7B26\\u4E32\\uFF0C\\u6307\\u5B9A\\u6D4F\\u89C8\\u5668CORS\\u8BF7\\u6C42\\u4F1A\\u989D\\u5916\\u53D1\\u9001\\u7684\\u5934\\u4FE1\\u606F\\u5B57\\u6BB5\\uFF0C\\u4E0A\\u4F8B\\u662FX-Custom-Header\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p><span style=\\\"color:#1c1f21;\\\">\\u9884\\u68C0\\u8BF7\\u6C42\\u7684\\u56DE\\u5E94</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u670D\\u52A1\\u5668\\u6536\\u5230\\\"\\u9884\\u68C0\\\"\\u8BF7\\u6C42\\u4EE5\\u540E\\uFF0C\\u68C0\\u67E5\\u4E86Origin\\u3001Access-Control-Request-Method\\u548CAccess-Control-Request-Headers\\u5B57\\u6BB5\\u4EE5\\u540E\\uFF0C\\u786E\\u8BA4\\u5141\\u8BB8\\u8DE8\\u6E90\\u8BF7\\u6C42\\uFF0C\\u5C31\\u53EF\\u4EE5\\u505A\\u51FA\\u56DE\\u5E94\\u3002<br><br> \\u2003\\u2003HTTP\\u56DE\\u5E94\\u4E2D\\uFF0C\\u9664\\u4E86\\u5173\\u952E\\u7684\\u662FAccess-Control-Allow-Origin\\u5B57\\u6BB5\\uFF0C\\u5176\\u4ED6CORS\\u76F8\\u5173\\u5B57\\u6BB5\\u5982\\u4E0B\\uFF1A<br><br><strong>1\\uFF09Access-Control-Allow-Methods</strong>\\uFF1A\\u5FC5\\u9009<br><br> \\u2003\\u2003\\u5B83\\u7684\\u503C\\u662F\\u9017\\u53F7\\u5206\\u9694\\u7684\\u4E00\\u4E2A\\u5B57\\u7B26\\u4E32\\uFF0C\\u8868\\u660E\\u670D\\u52A1\\u5668\\u652F\\u6301\\u7684\\u6240\\u6709\\u8DE8\\u57DF\\u8BF7\\u6C42\\u7684\\u65B9\\u6CD5\\u3002\\u6CE8\\u610F\\uFF0C\\u8FD4\\u56DE\\u7684\\u662F\\u6240\\u6709\\u652F\\u6301\\u7684\\u65B9\\u6CD5\\uFF0C\\u800C\\u4E0D\\u5355\\u662F\\u6D4F\\u89C8\\u5668\\u8BF7\\u6C42\\u7684\\u90A3\\u4E2A\\u65B9\\u6CD5\\u3002\\u8FD9\\u662F\\u4E3A\\u4E86\\u907F\\u514D\\u591A\\u6B21\\\"\\u9884\\u68C0\\\"\\u8BF7\\u6C42\\u3002<br><br><strong>2\\uFF09Access-Control-Allow-Headers</strong><br><br> \\u2003\\u2003\\u5982\\u679C\\u6D4F\\u89C8\\u5668\\u8BF7\\u6C42\\u5305\\u62ECAccess-Control-Request-Headers\\u5B57\\u6BB5\\uFF0C\\u5219Access-Control-Allow-Headers\\u5B57\\u6BB5\\u662F\\u5FC5\\u9700\\u7684\\u3002\\u5B83\\u4E5F\\u662F\\u4E00\\u4E2A\\u9017\\u53F7\\u5206\\u9694\\u7684\\u5B57\\u7B26\\u4E32\\uFF0C\\u8868\\u660E\\u670D\\u52A1\\u5668\\u652F\\u6301\\u7684\\u6240\\u6709\\u5934\\u4FE1\\u606F\\u5B57\\u6BB5\\uFF0C\\u4E0D\\u9650\\u4E8E\\u6D4F\\u89C8\\u5668\\u5728\\\"\\u9884\\u68C0\\\"\\u4E2D\\u8BF7\\u6C42\\u7684\\u5B57\\u6BB5\\u3002<br><br><strong>3\\uFF09Access-Control-Allow-Credentials</strong>\\uFF1A\\u53EF\\u9009<br><br> \\u2003\\u2003\\u8BE5\\u5B57\\u6BB5\\u4E0E\\u7B80\\u5355\\u8BF7\\u6C42\\u65F6\\u7684\\u542B\\u4E49\\u76F8\\u540C\\u3002<br><br><strong>4\\uFF09Access-Control-Max-Age</strong>\\uFF1A\\u53EF\\u9009<br><br> \\u2003\\u2003\\u7528\\u6765\\u6307\\u5B9A\\u672C\\u6B21\\u9884\\u68C0\\u8BF7\\u6C42\\u7684\\u6709\\u6548\\u671F\\uFF0C\\u5355\\u4F4D\\u4E3A\\u79D2\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\"><a name=\\\"t8\\\"></a><span style=\\\"color:#1c1f21;\\\">CORS\\u8DE8\\u57DF\\u793A\\u4F8B</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><strong>1\\uFF09\\u524D\\u7AEF\\u8BBE\\u7F6E</strong>\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">\\u539F\\u751Fajax\\uFF1A</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> xhr = <span class=\\\"hljs-keyword\\\">new</span> <span class=\\\"hljs-title class_\\\">XMLHttpRequest</span>(); <span class=\\\"hljs-comment\\\">// IE8/9\\u9700\\u7528window.XDomainRequest\\u517C\\u5BB9</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u524D\\u7AEF\\u8BBE\\u7F6E\\u662F\\u5426\\u5E26cookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-property\\\">withCredentials</span> = <span class=\\\"hljs-literal\\\">true</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-title function_\\\">open</span>(<span class=\\\"hljs-string\\\">'post'</span>, <span class=\\\"hljs-string\\\">'http://www.domain2.com:8080/login'</span>, <span class=\\\"hljs-literal\\\">true</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-title function_\\\">setRequestHeader</span>(<span class=\\\"hljs-string\\\">'Content-Type'</span>, <span class=\\\"hljs-string\\\">'application/x-www-form-urlencoded'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-title function_\\\">send</span>(<span class=\\\"hljs-string\\\">'user=admin'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-property\\\">onreadystatechange</span> = <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">if</span> (xhr.<span class=\\\"hljs-property\\\">readyState</span> == <span class=\\\"hljs-number\\\">4</span> &amp;&amp; xhr.<span class=\\\"hljs-property\\\">status</span> == <span class=\\\"hljs-number\\\">200</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-title function_\\\">alert</span>(xhr.<span class=\\\"hljs-property\\\">responseText</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">};</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">jquery ajax\\uFF1A</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">$.<span class=\\\"hljs-title function_\\\">ajax</span>({</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    ...</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">   <span class=\\\"hljs-attr\\\">xhrFields</span>: {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">       <span class=\\\"hljs-attr\\\">withCredentials</span>: <span class=\\\"hljs-literal\\\">true</span>    <span class=\\\"hljs-comment\\\">// \\u524D\\u7AEF\\u8BBE\\u7F6E\\u662F\\u5426\\u5E26cookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">   },</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">   <span class=\\\"hljs-attr\\\">crossDomain</span>: <span class=\\\"hljs-literal\\\">true</span>,   <span class=\\\"hljs-comment\\\">// \\u4F1A\\u8BA9\\u8BF7\\u6C42\\u5934\\u4E2D\\u5305\\u542B\\u8DE8\\u57DF\\u7684\\u989D\\u5916\\u4FE1\\u606F\\uFF0C\\u4F46\\u4E0D\\u4F1A\\u542Bcookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    ...</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><strong>2\\uFF09\\u670D\\u52A1\\u7AEF\\u8BBE\\u7F6E</strong>\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">nodejs\\u4EE3\\u7801</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:1018px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> http = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'http'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> server = http.<span class=\\\"hljs-title function_\\\">createServer</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> qs = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'querystring'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">server.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'request'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">req, res</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> postData = <span class=\\\"hljs-string\\\">''</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u6570\\u636E\\u5757\\u63A5\\u6536\\u4E2D</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    req.<span class=\\\"hljs-title function_\\\">addListener</span>(<span class=\\\"hljs-string\\\">'data'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">chunk</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        postData += chunk;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u6570\\u636E\\u63A5\\u6536\\u5B8C\\u6BD5</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    req.<span class=\\\"hljs-title function_\\\">addListener</span>(<span class=\\\"hljs-string\\\">'end'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        postData = qs.<span class=\\\"hljs-title function_\\\">parse</span>(postData);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"17\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-comment\\\">// \\u8DE8\\u57DF\\u540E\\u53F0\\u8BBE\\u7F6E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"18\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        res.<span class=\\\"hljs-title function_\\\">writeHead</span>(<span class=\\\"hljs-number\\\">200</span>, {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"19\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-string\\\">'Access-Control-Allow-Credentials'</span>: <span class=\\\"hljs-string\\\">'true'</span>,     <span class=\\\"hljs-comment\\\">// \\u540E\\u7AEF\\u5141\\u8BB8\\u53D1\\u9001Cookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"20\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-string\\\">'Access-Control-Allow-Origin'</span>: <span class=\\\"hljs-string\\\">'http://www.domain1.com'</span>,    <span class=\\\"hljs-comment\\\">// \\u5141\\u8BB8\\u8BBF\\u95EE\\u7684\\u57DF\\uFF08\\u534F\\u8BAE+\\u57DF\\u540D+\\u7AEF\\u53E3\\uFF09</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"21\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-comment\\\"><span class=\\\"hljs-comment\\\">/* </span></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"22\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">             * \\u6B64\\u5904\\u8BBE\\u7F6E\\u7684cookie\\u8FD8\\u662Fdomain2\\u7684\\u800C\\u975Edomain1\\uFF0C\\u56E0\\u4E3A\\u540E\\u7AEF\\u4E5F\\u4E0D\\u80FD\\u8DE8\\u57DF\\u5199cookie(nginx\\u53CD\\u5411\\u4EE3\\u7406\\u53EF\\u4EE5\\u5B9E\\u73B0)\\uFF0C</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"23\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">             * \\u4F46\\u53EA\\u8981domain2\\u4E2D\\u5199\\u5165\\u4E00\\u6B21cookie\\u8BA4\\u8BC1\\uFF0C\\u540E\\u9762\\u7684\\u8DE8\\u57DF\\u63A5\\u53E3\\u90FD\\u80FD\\u4ECEdomain2\\u4E2D\\u83B7\\u53D6cookie\\uFF0C\\u4ECE\\u800C\\u5B9E\\u73B0\\u6240\\u6709\\u7684\\u63A5\\u53E3\\u90FD\\u80FD\\u8DE8\\u57DF\\u8BBF\\u95EE</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"24\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">             */</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"25\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-string\\\">'Set-Cookie'</span>: <span class=\\\"hljs-string\\\">'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly'</span>  <span class=\\\"hljs-comment\\\">// HttpOnly\\u7684\\u4F5C\\u7528\\u662F\\u8BA9js\\u65E0\\u6CD5\\u8BFB\\u53D6cookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"26\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"27\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"28\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        res.<span class=\\\"hljs-title function_\\\">write</span>(<span class=\\\"hljs-title class_\\\">JSON</span>.<span class=\\\"hljs-title function_\\\">stringify</span>(postData));</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"29\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        res.<span class=\\\"hljs-title function_\\\">end</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"30\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"31\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"32\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"33\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">server.<span class=\\\"hljs-title function_\\\">listen</span>(<span class=\\\"hljs-string\\\">'8080'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"34\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'Server is running at port 8080...'</span>);</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\"id=\\\"article-md-title-6\\\"><a name=\\\"t9\\\"></a><span style=\\\"color:#1c1f21;\\\">3\\u3001nginx\\u4EE3\\u7406\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003nginx\\u4EE3\\u7406\\u8DE8\\u57DF\\uFF0C\\u5B9E\\u8D28\\u548CCORS\\u8DE8\\u57DF\\u539F\\u7406\\u4E00\\u6837\\uFF0C\\u901A\\u8FC7\\u914D\\u7F6E\\u6587\\u4EF6\\u8BBE\\u7F6E\\u8BF7\\u6C42\\u54CD\\u5E94\\u5934<span style=\\\"color:#ff502c;\\\">Access-Control-Allow-Origin</span>\\u2026\\u7B49\\u5B57\\u6BB5\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p><span style=\\\"color:#1c1f21;\\\">1\\uFF09nginx\\u914D\\u7F6E\\u89E3\\u51B3iconfont\\u8DE8\\u57DF</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u6D4F\\u89C8\\u5668\\u8DE8\\u57DF\\u8BBF\\u95EEjs\\u3001css\\u3001img\\u7B49\\u5E38\\u89C4\\u9759\\u6001\\u8D44\\u6E90\\u88AB\\u540C\\u6E90\\u7B56\\u7565\\u8BB8\\u53EF\\uFF0C\\u4F46iconfont\\u5B57\\u4F53\\u6587\\u4EF6(eot|otf|ttf|woff|svg)\\u4F8B\\u5916\\uFF0C\\u6B64\\u65F6\\u53EF\\u5728nginx\\u7684\\u9759\\u6001\\u8D44\\u6E90\\u670D\\u52A1\\u5668\\u4E2D\\u52A0\\u5165\\u4EE5\\u4E0B\\u914D\\u7F6E\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-undefined\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">location / {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">  add_header Access-Control-Allow-Origin *;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">}</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p><span style=\\\"color:#1c1f21;\\\">2\\uFF09nginx\\u53CD\\u5411\\u4EE3\\u7406\\u63A5\\u53E3\\u8DE8\\u57DF</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <blockquote> \\n    <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u8DE8\\u57DF\\u95EE\\u9898\\uFF1A\\u540C\\u6E90\\u7B56\\u7565\\u4EC5\\u662F\\u9488\\u5BF9\\u6D4F\\u89C8\\u5668\\u7684\\u5B89\\u5168\\u7B56\\u7565\\u3002\\u670D\\u52A1\\u5668\\u7AEF\\u8C03\\u7528HTTP\\u63A5\\u53E3\\u53EA\\u662F\\u4F7F\\u7528HTTP\\u534F\\u8BAE\\uFF0C\\u4E0D\\u9700\\u8981\\u540C\\u6E90\\u7B56\\u7565\\uFF0C\\u4E5F\\u5C31\\u4E0D\\u5B58\\u5728\\u8DE8\\u57DF\\u95EE\\u9898\\u3002</span></p> \\n   </blockquote> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u5B9E\\u73B0\\u601D\\u8DEF\\uFF1A\\u901A\\u8FC7Nginx\\u914D\\u7F6E\\u4E00\\u4E2A\\u4EE3\\u7406\\u670D\\u52A1\\u5668\\u57DF\\u540D\\u4E0Edomain1\\u76F8\\u540C\\uFF0C\\u7AEF\\u53E3\\u4E0D\\u540C\\uFF09\\u505A\\u8DF3\\u677F\\u673A\\uFF0C\\u53CD\\u5411\\u4EE3\\u7406\\u8BBF\\u95EEdomain2\\u63A5\\u53E3\\uFF0C\\u5E76\\u4E14\\u53EF\\u4EE5\\u987A\\u4FBF\\u4FEE\\u6539cookie\\u4E2Ddomain\\u4FE1\\u606F\\uFF0C\\u65B9\\u4FBF\\u5F53\\u524D\\u57DFcookie\\u5199\\u5165\\uFF0C\\u5B9E\\u73B0\\u8DE8\\u57DF\\u8BBF\\u95EE\\u3002<br><br> nginx\\u5177\\u4F53\\u914D\\u7F6E\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-perl\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:940px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">#proxy\\u670D\\u52A1\\u5668</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">server {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">listen</span>       <span class=\\\"hljs-number\\\">81</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    server_name  www.domain1.com;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    location / {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        proxy_pass   http:<span class=\\\"hljs-regexp\\\">//</span>www.domain2.com:<span class=\\\"hljs-number\\\">8080</span>;  <span class=\\\"hljs-comment\\\">#\\u53CD\\u5411\\u4EE3\\u7406</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        proxy_cookie_domain www.domain2.com www.domain1.com; <span class=\\\"hljs-comment\\\">#\\u4FEE\\u6539cookie\\u91CC\\u57DF\\u540D</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-keyword\\\">index</span>  index.html index.htm;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-comment\\\"># \\u5F53\\u7528webpack-dev-server\\u7B49\\u4E2D\\u95F4\\u4EF6\\u4EE3\\u7406\\u63A5\\u53E3\\u8BBF\\u95EEnignx\\u65F6\\uFF0C\\u6B64\\u65F6\\u65E0\\u6D4F\\u89C8\\u5668\\u53C2\\u4E0E\\uFF0C\\u6545\\u6CA1\\u6709\\u540C\\u6E90\\u9650\\u5236\\uFF0C\\u4E0B\\u9762\\u7684\\u8DE8\\u57DF\\u914D\\u7F6E\\u53EF\\u4E0D\\u542F\\u7528</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        add_header Access-Control-Allow-Origin http:<span class=\\\"hljs-regexp\\\">//</span>www.domain1.com;  <span class=\\\"hljs-comment\\\">#\\u5F53\\u524D\\u7AEF\\u53EA\\u8DE8\\u57DF\\u4E0D\\u5E26cookie\\u65F6\\uFF0C\\u53EF\\u4E3A*</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        add_header Access-Control-Allow-Credentials true;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">}</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-7\\\"><a name=\\\"t10\\\"></a><span style=\\\"color:#1c1f21;\\\">4\\u3001nodejs\\u4E2D\\u95F4\\u4EF6\\u4EE3\\u7406\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003node\\u4E2D\\u95F4\\u4EF6\\u5B9E\\u73B0\\u8DE8\\u57DF\\u4EE3\\u7406\\uFF0C\\u539F\\u7406\\u5927\\u81F4\\u4E0Enginx\\u76F8\\u540C\\uFF0C\\u90FD\\u662F\\u901A\\u8FC7\\u542F\\u4E00\\u4E2A\\u4EE3\\u7406\\u670D\\u52A1\\u5668\\uFF0C\\u5B9E\\u73B0\\u6570\\u636E\\u7684\\u8F6C\\u53D1\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u901A\\u8FC7\\u8BBE\\u7F6EcookieDomainRewrite\\u53C2\\u6570\\u4FEE\\u6539\\u54CD\\u5E94\\u5934\\u4E2Dcookie\\u4E2D\\u57DF\\u540D\\uFF0C\\u5B9E\\u73B0\\u5F53\\u524D\\u57DF\\u7684cookie\\u5199\\u5165\\uFF0C\\u65B9\\u4FBF\\u63A5\\u53E3\\u767B\\u5F55\\u8BA4\\u8BC1\\u3002<br><br><strong>1\\uFF09\\u975Evue\\u6846\\u67B6\\u7684\\u8DE8\\u57DF</strong><br><br> \\u2003\\u2003\\u4F7F\\u7528node + express + http-proxy-middleware\\u642D\\u5EFA\\u4E00\\u4E2Aproxy\\u670D\\u52A1\\u5668\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">\\u524D\\u7AEF\\u4EE3\\u7801\\uFF1A</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> xhr = <span class=\\\"hljs-keyword\\\">new</span> <span class=\\\"hljs-title class_\\\">XMLHttpRequest</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u524D\\u7AEF\\u5F00\\u5173\\uFF1A\\u6D4F\\u89C8\\u5668\\u662F\\u5426\\u8BFB\\u5199cookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-property\\\">withCredentials</span> = <span class=\\\"hljs-literal\\\">true</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u8BBF\\u95EEhttp-proxy-middleware\\u4EE3\\u7406\\u670D\\u52A1\\u5668</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-title function_\\\">open</span>(<span class=\\\"hljs-string\\\">'get'</span>, <span class=\\\"hljs-string\\\">'http://www.domain1.com:3000/login?user=admin'</span>, <span class=\\\"hljs-literal\\\">true</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">xhr.<span class=\\\"hljs-title function_\\\">send</span>();</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">\\u4E2D\\u95F4\\u4EF6\\u670D\\u52A1\\u5668\\u4EE3\\u7801\\uFF1A</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> express = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'express'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> proxy = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'http-proxy-middleware'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> app = <span class=\\\"hljs-title function_\\\">express</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">app.<span class=\\\"hljs-title function_\\\">use</span>(<span class=\\\"hljs-string\\\">'/'</span>, <span class=\\\"hljs-title function_\\\">proxy</span>({</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u4EE3\\u7406\\u8DE8\\u57DF\\u76EE\\u6807\\u63A5\\u53E3</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-attr\\\">target</span>: <span class=\\\"hljs-string\\\">'http://www.domain2.com:8080'</span>,</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-attr\\\">changeOrigin</span>: <span class=\\\"hljs-literal\\\">true</span>,</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u4FEE\\u6539\\u54CD\\u5E94\\u5934\\u4FE1\\u606F\\uFF0C\\u5B9E\\u73B0\\u8DE8\\u57DF\\u5E76\\u5141\\u8BB8\\u5E26cookie</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-attr\\\">onProxyRes</span>: <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">proxyRes, req, res</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        res.<span class=\\\"hljs-title function_\\\">header</span>(<span class=\\\"hljs-string\\\">'Access-Control-Allow-Origin'</span>, <span class=\\\"hljs-string\\\">'http://www.domain1.com'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        res.<span class=\\\"hljs-title function_\\\">header</span>(<span class=\\\"hljs-string\\\">'Access-Control-Allow-Credentials'</span>, <span class=\\\"hljs-string\\\">'true'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    },</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u4FEE\\u6539\\u54CD\\u5E94\\u4FE1\\u606F\\u4E2D\\u7684cookie\\u57DF\\u540D</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"17\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-attr\\\">cookieDomainRewrite</span>: <span class=\\\"hljs-string\\\">'www.domain1.com'</span>  <span class=\\\"hljs-comment\\\">// \\u53EF\\u4EE5\\u4E3Afalse\\uFF0C\\u8868\\u793A\\u4E0D\\u4FEE\\u6539</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"18\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">}));</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"19\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"20\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">app.<span class=\\\"hljs-title function_\\\">listen</span>(<span class=\\\"hljs-number\\\">3000</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"21\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'Proxy server is listen at port 3000...'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"22\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\" data-report-view=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><strong>2\\uFF09vue\\u6846\\u67B6\\u7684\\u8DE8\\u57DF</strong><br><br> \\u2003\\u2003node + vue + webpack + webpack-dev-server\\u642D\\u5EFA\\u7684\\u9879\\u76EE\\uFF0C\\u8DE8\\u57DF\\u8BF7\\u6C42\\u63A5\\u53E3\\uFF0C\\u76F4\\u63A5\\u4FEE\\u6539webpack.config.js\\u914D\\u7F6E\\u3002\\u5F00\\u53D1\\u73AF\\u5883\\u4E0B\\uFF0Cvue\\u6E32\\u67D3\\u670D\\u52A1\\u548C\\u63A5\\u53E3\\u4EE3\\u7406\\u670D\\u52A1\\u90FD\\u662Fwebpack-dev-server\\u540C\\u4E00\\u4E2A\\uFF0C\\u6240\\u4EE5\\u9875\\u9762\\u4E0E\\u4EE3\\u7406\\u63A5\\u53E3\\u4E4B\\u95F4\\u4E0D\\u518D\\u8DE8\\u57DF\\u3002<br><br> webpack.config.js\\u90E8\\u5206\\u914D\\u7F6E\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-java\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">module</span>.<span class=\\\"hljs-keyword\\\">exports</span> = {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    entry: {},</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">module</span>: {},</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    ...</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    devServer: {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        historyApiFallback: <span class=\\\"hljs-literal\\\">true</span>,</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        proxy: [{</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            context: <span class=\\\"hljs-string\\\">'/login'</span>,</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            target: <span class=\\\"hljs-string\\\">'http://www.domain2.com:8080'</span>,  <span class=\\\"hljs-comment\\\">// \\u4EE3\\u7406\\u8DE8\\u57DF\\u76EE\\u6807\\u63A5\\u53E3</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            changeOrigin: <span class=\\\"hljs-literal\\\">true</span>,</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            secure: <span class=\\\"hljs-literal\\\">false</span>,  <span class=\\\"hljs-comment\\\">// \\u5F53\\u4EE3\\u7406\\u67D0\\u4E9Bhttps\\u670D\\u52A1\\u62A5\\u9519\\u65F6\\u7528</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            cookieDomainRewrite: <span class=\\\"hljs-string\\\">'www.domain1.com'</span>  <span class=\\\"hljs-comment\\\">// \\u53EF\\u4EE5\\u4E3Afalse\\uFF0C\\u8868\\u793A\\u4E0D\\u4FEE\\u6539</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        }],</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        noInfo: <span class=\\\"hljs-literal\\\">true</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">}</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\" data-report-view=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-8\\\"><a name=\\\"t11\\\"></a><span style=\\\"color:#1c1f21;\\\">5\\u3001document.domain + iframe\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u6B64\\u65B9\\u6848\\u4EC5\\u9650\\u4E3B\\u57DF\\u76F8\\u540C\\uFF0C\\u5B50\\u57DF\\u4E0D\\u540C\\u7684\\u8DE8\\u57DF\\u5E94\\u7528\\u573A\\u666F\\u3002\\u5B9E\\u73B0\\u539F\\u7406\\uFF1A\\u4E24\\u4E2A\\u9875\\u9762\\u90FD\\u901A\\u8FC7js\\u5F3A\\u5236\\u8BBE\\u7F6Edocument.domain\\u4E3A\\u57FA\\u7840\\u4E3B\\u57DF\\uFF0C\\u5C31\\u5B9E\\u73B0\\u4E86\\u540C\\u57DF\\u3002<br><br> 1\\uFF09\\u7236\\u7A97\\u53E3\\uFF1A(<a href=\\\"http://www.domain.com/a.html\\\">http://www.domain.com/a.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">iframe</span> <span class=\\\"hljs-attr\\\">id</span>=<span class=\\\"hljs-string\\\">\\\"iframe\\\"</span> <span class=\\\"hljs-attr\\\">src</span>=<span class=\\\"hljs-string\\\">\\\"http://child.domain.com/b.html\\\"</span>&gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">iframe</span>&gt;</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-property\\\">domain</span> = <span class=\\\"hljs-string\\\">'domain.com'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> user = <span class=\\\"hljs-string\\\">'admin'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">1\\uFF09\\u5B50\\u7A97\\u53E3\\uFF1A(<a href=\\\"http://child.domain.com/a.html\\\">http://child.domain.com/a.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-property\\\">domain</span> = <span class=\\\"hljs-string\\\">'domain.com'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u83B7\\u53D6\\u7236\\u7A97\\u53E3\\u4E2D\\u53D8\\u91CF</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'get js data from parent ---&gt; '</span> + <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-property\\\">parent</span>.<span class=\\\"hljs-property\\\">user</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-9\\\"><a name=\\\"t12\\\"></a><span style=\\\"color:#1c1f21;\\\">6\\u3001location.hash + iframe\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u5B9E\\u73B0\\u539F\\u7406\\uFF1A a\\u6B32\\u4E0Eb\\u8DE8\\u57DF\\u76F8\\u4E92\\u901A\\u4FE1\\uFF0C\\u901A\\u8FC7\\u4E2D\\u95F4\\u9875c\\u6765\\u5B9E\\u73B0\\u3002 \\u4E09\\u4E2A\\u9875\\u9762\\uFF0C\\u4E0D\\u540C\\u57DF\\u4E4B\\u95F4\\u5229\\u7528iframe\\u7684location.hash\\u4F20\\u503C\\uFF0C\\u76F8\\u540C\\u57DF\\u4E4B\\u95F4\\u76F4\\u63A5js\\u8BBF\\u95EE\\u6765\\u901A\\u4FE1\\u3002<br><br> \\u2003\\u2003\\u5177\\u4F53\\u5B9E\\u73B0\\uFF1AA\\u57DF\\uFF1Aa.html -&gt; B\\u57DF\\uFF1Ab.html -&gt; A\\u57DF\\uFF1Ac.html\\uFF0Ca\\u4E0Eb\\u4E0D\\u540C\\u57DF\\u53EA\\u80FD\\u901A\\u8FC7hash\\u503C\\u5355\\u5411\\u901A\\u4FE1\\uFF0Cb\\u4E0Ec\\u4E5F\\u4E0D\\u540C\\u57DF\\u4E5F\\u53EA\\u80FD\\u5355\\u5411\\u901A\\u4FE1\\uFF0C\\u4F46c\\u4E0Ea\\u540C\\u57DF\\uFF0C\\u6240\\u4EE5c\\u53EF\\u901A\\u8FC7parent.parent\\u8BBF\\u95EEa\\u9875\\u9762\\u6240\\u6709\\u5BF9\\u8C61\\u3002<br><br> 1\\uFF09a.html\\uFF1A(<a href=\\\"http://www.domain1.com/a.html\\\">http://www.domain1.com/a.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:807px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">iframe</span> <span class=\\\"hljs-attr\\\">id</span>=<span class=\\\"hljs-string\\\">\\\"iframe\\\"</span> <span class=\\\"hljs-attr\\\">src</span>=<span class=\\\"hljs-string\\\">\\\"http://www.domain2.com/b.html\\\"</span> <span class=\\\"hljs-attr\\\">style</span>=<span class=\\\"hljs-string\\\">\\\"display:none;\\\"</span>&gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">iframe</span>&gt;</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> iframe = <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-title function_\\\">getElementById</span>(<span class=\\\"hljs-string\\\">'iframe'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u5411b.html\\u4F20hash\\u503C</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-built_in\\\">setTimeout</span>(<span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        iframe.<span class=\\\"hljs-property\\\">src</span> = iframe.<span class=\\\"hljs-property\\\">src</span> + <span class=\\\"hljs-string\\\">'#user=admin'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }, <span class=\\\"hljs-number\\\">1000</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u5F00\\u653E\\u7ED9\\u540C\\u57DFc.html\\u7684\\u56DE\\u8C03\\u65B9\\u6CD5</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">function</span> <span class=\\\"hljs-title function_\\\">onCallback</span>(<span class=\\\"hljs-params\\\">res</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-title function_\\\">alert</span>(<span class=\\\"hljs-string\\\">'data from c.html ---&gt; '</span> + res);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">2\\uFF09b.html\\uFF1A(<a href=\\\"http://www.domain2.com/b.html\\\">http://www.domain2.com/b.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:807px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">iframe</span> <span class=\\\"hljs-attr\\\">id</span>=<span class=\\\"hljs-string\\\">\\\"iframe\\\"</span> <span class=\\\"hljs-attr\\\">src</span>=<span class=\\\"hljs-string\\\">\\\"http://www.domain1.com/c.html\\\"</span> <span class=\\\"hljs-attr\\\">style</span>=<span class=\\\"hljs-string\\\">\\\"display:none;\\\"</span>&gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">iframe</span>&gt;</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> iframe = <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-title function_\\\">getElementById</span>(<span class=\\\"hljs-string\\\">'iframe'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u76D1\\u542Ca.html\\u4F20\\u6765\\u7684hash\\u503C\\uFF0C\\u518D\\u4F20\\u7ED9c.html</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-property\\\">onhashchange</span> = <span class=\\\"hljs-keyword\\\">function</span> (<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        iframe.<span class=\\\"hljs-property\\\">src</span> = iframe.<span class=\\\"hljs-property\\\">src</span> + location.<span class=\\\"hljs-property\\\">hash</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    };</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">3\\uFF09c.html\\uFF1A(<a href=\\\"http://www.domain1.com/c.html\\\">http://www.domain1.com/c.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:824px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u76D1\\u542Cb.html\\u4F20\\u6765\\u7684hash\\u503C</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-property\\\">onhashchange</span> = <span class=\\\"hljs-keyword\\\">function</span> (<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-comment\\\">// \\u518D\\u901A\\u8FC7\\u64CD\\u4F5C\\u540C\\u57DFa.html\\u7684js\\u56DE\\u8C03\\uFF0C\\u5C06\\u7ED3\\u679C\\u4F20\\u56DE</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-property\\\">parent</span>.<span class=\\\"hljs-property\\\">parent</span>.<span class=\\\"hljs-title function_\\\">onCallback</span>(<span class=\\\"hljs-string\\\">'hello: '</span> + location.<span class=\\\"hljs-property\\\">hash</span>.<span class=\\\"hljs-title function_\\\">replace</span>(<span class=\\\"hljs-string\\\">'#user='</span>, <span class=\\\"hljs-string\\\">''</span>));</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    };</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-10\\\"><a name=\\\"t13\\\"></a><span style=\\\"color:#1c1f21;\\\">7\\u3001window.name + iframe\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003window.name\\u5C5E\\u6027\\u7684\\u72EC\\u7279\\u4E4B\\u5904\\uFF1Aname\\u503C\\u5728\\u4E0D\\u540C\\u7684\\u9875\\u9762\\uFF08\\u751A\\u81F3\\u4E0D\\u540C\\u57DF\\u540D\\uFF09\\u52A0\\u8F7D\\u540E\\u4F9D\\u65E7\\u5B58\\u5728\\uFF0C\\u5E76\\u4E14\\u53EF\\u4EE5\\u652F\\u6301\\u975E\\u5E38\\u957F\\u7684 name \\u503C\\uFF082MB\\uFF09\\u3002<br><br> 1\\uFF09a.html\\uFF1A(<a href=\\\"http://www.domain1.com/a.html\\\">http://www.domain1.com/a.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> proxy = <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">url, callback</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> state = <span class=\\\"hljs-number\\\">0</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> iframe = <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-title function_\\\">createElement</span>(<span class=\\\"hljs-string\\\">'iframe'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u52A0\\u8F7D\\u8DE8\\u57DF\\u9875\\u9762</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    iframe.<span class=\\\"hljs-property\\\">src</span> = url;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// onload\\u4E8B\\u4EF6\\u4F1A\\u89E6\\u53D12\\u6B21\\uFF0C\\u7B2C1\\u6B21\\u52A0\\u8F7D\\u8DE8\\u57DF\\u9875\\uFF0C\\u5E76\\u7559\\u5B58\\u6570\\u636E\\u4E8Ewindow.name</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    iframe.<span class=\\\"hljs-property\\\">onload</span> = <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-keyword\\\">if</span> (state === <span class=\\\"hljs-number\\\">1</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-comment\\\">// \\u7B2C2\\u6B21onload(\\u540C\\u57DFproxy\\u9875)\\u6210\\u529F\\u540E\\uFF0C\\u8BFB\\u53D6\\u540C\\u57DFwindow.name\\u4E2D\\u6570\\u636E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-title function_\\\">callback</span>(iframe.<span class=\\\"hljs-property\\\">contentWindow</span>.<span class=\\\"hljs-property\\\">name</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-title function_\\\">destoryFrame</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        } <span class=\\\"hljs-keyword\\\">else</span> <span class=\\\"hljs-keyword\\\">if</span> (state === <span class=\\\"hljs-number\\\">0</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-comment\\\">// \\u7B2C1\\u6B21onload(\\u8DE8\\u57DF\\u9875)\\u6210\\u529F\\u540E\\uFF0C\\u5207\\u6362\\u5230\\u540C\\u57DF\\u4EE3\\u7406\\u9875\\u9762</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"17\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            iframe.<span class=\\\"hljs-property\\\">contentWindow</span>.<span class=\\\"hljs-property\\\">location</span> = <span class=\\\"hljs-string\\\">'http://www.domain1.com/proxy.html'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"18\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            state = <span class=\\\"hljs-number\\\">1</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"19\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"20\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    };</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"21\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"22\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-property\\\">body</span>.<span class=\\\"hljs-title function_\\\">appendChild</span>(iframe);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"23\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"24\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u83B7\\u53D6\\u6570\\u636E\\u4EE5\\u540E\\u9500\\u6BC1\\u8FD9\\u4E2Aiframe\\uFF0C\\u91CA\\u653E\\u5185\\u5B58\\uFF1B\\u8FD9\\u4E5F\\u4FDD\\u8BC1\\u4E86\\u5B89\\u5168\\uFF08\\u4E0D\\u88AB\\u5176\\u4ED6\\u57DFframe js\\u8BBF\\u95EE\\uFF09</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"25\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">function</span> <span class=\\\"hljs-title function_\\\">destoryFrame</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"26\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        iframe.<span class=\\\"hljs-property\\\">contentWindow</span>.<span class=\\\"hljs-property\\\">document</span>.<span class=\\\"hljs-title function_\\\">write</span>(<span class=\\\"hljs-string\\\">''</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"27\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        iframe.<span class=\\\"hljs-property\\\">contentWindow</span>.<span class=\\\"hljs-title function_\\\">close</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"28\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-property\\\">body</span>.<span class=\\\"hljs-title function_\\\">removeChild</span>(iframe);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"29\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"30\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">};</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"31\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"32\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u8BF7\\u6C42\\u8DE8\\u57DFb\\u9875\\u9762\\u6570\\u636E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"33\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-title function_\\\">proxy</span>(<span class=\\\"hljs-string\\\">'http://www.domain2.com/b.html'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">data</span>){</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"34\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-title function_\\\">alert</span>(data);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"35\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\" data-report-view=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">2\\uFF09proxy.html\\uFF1A(<a href=\\\"http://www.domain1.com/proxy.html\\\">http://www.domain1.com/proxy.html</a>)<br><br> \\u2003\\u2003\\u4E2D\\u95F4\\u4EE3\\u7406\\u9875\\uFF0C\\u4E0Ea.html\\u540C\\u57DF\\uFF0C\\u5185\\u5BB9\\u4E3A\\u7A7A\\u5373\\u53EF\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">3\\uFF09b.html\\uFF1A(<a href=\\\"http://www.domain2.com/b.html\\\">http://www.domain2.com/b.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-property\\\">name</span> = <span class=\\\"hljs-string\\\">'This is domain2 data!'</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u901A\\u8FC7iframe\\u7684src\\u5C5E\\u6027\\u7531\\u5916\\u57DF\\u8F6C\\u5411\\u672C\\u5730\\u57DF\\uFF0C\\u8DE8\\u57DF\\u6570\\u636E\\u5373\\u7531iframe\\u7684window.name\\u4ECE\\u5916\\u57DF\\u4F20\\u9012\\u5230\\u672C\\u5730\\u57DF\\u3002\\u8FD9\\u4E2A\\u5C31\\u5DE7\\u5999\\u5730\\u7ED5\\u8FC7\\u4E86\\u6D4F\\u89C8\\u5668\\u7684\\u8DE8\\u57DF\\u8BBF\\u95EE\\u9650\\u5236\\uFF0C\\u4F46\\u540C\\u65F6\\u5B83\\u53C8\\u662F\\u5B89\\u5168\\u64CD\\u4F5C\\u3002</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-11\\\"><a name=\\\"t14\\\"></a><span style=\\\"color:#1c1f21;\\\">8\\u3001postMessage\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003postMessage\\u662FHTML5 XMLHttpRequest Level 2\\u4E2D\\u7684API\\uFF0C\\u4E14\\u662F\\u4E3A\\u6570\\u4E0D\\u591A\\u53EF\\u4EE5\\u8DE8\\u57DF\\u64CD\\u4F5C\\u7684window\\u5C5E\\u6027\\u4E4B\\u4E00\\uFF0C\\u5B83\\u53EF\\u7528\\u4E8E\\u89E3\\u51B3\\u4EE5\\u4E0B\\u65B9\\u9762\\u7684\\u95EE\\u9898\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\">\\u9875\\u9762\\u548C\\u5176\\u6253\\u5F00\\u7684\\u65B0\\u7A97\\u53E3\\u7684\\u6570\\u636E\\u4F20\\u9012</span></li><li><span style=\\\"color:#1c1f21;\\\">\\u591A\\u7A97\\u53E3\\u4E4B\\u95F4\\u6D88\\u606F\\u4F20\\u9012</span></li><li><span style=\\\"color:#1c1f21;\\\">\\u9875\\u9762\\u4E0E\\u5D4C\\u5957\\u7684iframe\\u6D88\\u606F\\u4F20\\u9012</span></li><li><span style=\\\"color:#1c1f21;\\\">\\u4E0A\\u9762\\u4E09\\u4E2A\\u573A\\u666F\\u7684\\u8DE8\\u57DF\\u6570\\u636E\\u4F20\\u9012</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u7528\\u6CD5\\uFF1ApostMessage(data,origin)\\u65B9\\u6CD5\\u63A5\\u53D7\\u4E24\\u4E2A\\u53C2\\u6570\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <ul style=\\\"margin-left:0px;\\\"><li><span style=\\\"color:#1c1f21;\\\"><strong>data</strong>\\uFF1A html5\\u89C4\\u8303\\u652F\\u6301\\u4EFB\\u610F\\u57FA\\u672C\\u7C7B\\u578B\\u6216\\u53EF\\u590D\\u5236\\u7684\\u5BF9\\u8C61\\uFF0C\\u4F46\\u90E8\\u5206\\u6D4F\\u89C8\\u5668\\u53EA\\u652F\\u6301\\u5B57\\u7B26\\u4E32\\uFF0C\\u6240\\u4EE5\\u4F20\\u53C2\\u65F6\\u6700\\u597D\\u7528JSON.stringify()\\u5E8F\\u5217\\u5316\\u3002</span></li><li><span style=\\\"color:#1c1f21;\\\"><strong>origin</strong>\\uFF1A \\u534F\\u8BAE+\\u4E3B\\u673A+\\u7AEF\\u53E3\\u53F7\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u8BBE\\u7F6E\\u4E3A\\\"*\\\"\\uFF0C\\u8868\\u793A\\u53EF\\u4EE5\\u4F20\\u9012\\u7ED9\\u4EFB\\u610F\\u7A97\\u53E3\\uFF0C\\u5982\\u679C\\u8981\\u6307\\u5B9A\\u548C\\u5F53\\u524D\\u7A97\\u53E3\\u540C\\u6E90\\u7684\\u8BDD\\u8BBE\\u7F6E\\u4E3A\\\"/\\\"\\u3002</span></li></ul>\\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">1\\uFF09a.html\\uFF1A(<a href=\\\"http://www.domain1.com/a.html\\\">http://www.domain1.com/a.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"set-code-hide\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:824px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">iframe</span> <span class=\\\"hljs-attr\\\">id</span>=<span class=\\\"hljs-string\\\">\\\"iframe\\\"</span> <span class=\\\"hljs-attr\\\">src</span>=<span class=\\\"hljs-string\\\">\\\"http://www.domain2.com/b.html\\\"</span> <span class=\\\"hljs-attr\\\">style</span>=<span class=\\\"hljs-string\\\">\\\"display:none;\\\"</span>&gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">iframe</span>&gt;</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\">       </span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-keyword\\\">var</span> iframe = <span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-title function_\\\">getElementById</span>(<span class=\\\"hljs-string\\\">'iframe'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    iframe.<span class=\\\"hljs-property\\\">onload</span> = <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-keyword\\\">var</span> data = {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-attr\\\">name</span>: <span class=\\\"hljs-string\\\">'aym'</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        };</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-comment\\\">// \\u5411domain2\\u4F20\\u9001\\u8DE8\\u57DF\\u6570\\u636E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        iframe.<span class=\\\"hljs-property\\\">contentWindow</span>.<span class=\\\"hljs-title function_\\\">postMessage</span>(<span class=\\\"hljs-title class_\\\">JSON</span>.<span class=\\\"hljs-title function_\\\">stringify</span>(data), <span class=\\\"hljs-string\\\">'http://www.domain2.com'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    };</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u63A5\\u53D7domain2\\u8FD4\\u56DE\\u6570\\u636E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-title function_\\\">addEventListener</span>(<span class=\\\"hljs-string\\\">'message'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">e</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-title function_\\\">alert</span>(<span class=\\\"hljs-string\\\">'data from domain2 ---&gt; '</span> + e.<span class=\\\"hljs-property\\\">data</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }, <span class=\\\"hljs-literal\\\">false</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span><div class=\\\"hide-preCode-box\\\"><span class=\\\"hide-preCode-bt\\\" data-report-view=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\\\"><img class=\\\"look-more-preCode contentImg-no-view\\\" src=\\\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\\\" alt=\\\"\\\" title=\\\"\\\"></span></div></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">2\\uFF09b.html\\uFF1A(<a href=\\\"http://www.domain2.com/b.html\\\">http://www.domain2.com/b.html</a>)</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:799px\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u63A5\\u6536domain1\\u7684\\u6570\\u636E</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-title function_\\\">addEventListener</span>(<span class=\\\"hljs-string\\\">'message'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">e</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-title function_\\\">alert</span>(<span class=\\\"hljs-string\\\">'data from domain1 ---&gt; '</span> + e.<span class=\\\"hljs-property\\\">data</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-keyword\\\">var</span> data = <span class=\\\"hljs-title class_\\\">JSON</span>.<span class=\\\"hljs-title function_\\\">parse</span>(e.<span class=\\\"hljs-property\\\">data</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-keyword\\\">if</span> (data) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            data.<span class=\\\"hljs-property\\\">number</span> = <span class=\\\"hljs-number\\\">16</span>;</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-comment\\\">// \\u5904\\u7406\\u540E\\u518D\\u53D1\\u56DEdomain1</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">            <span class=\\\"hljs-variable language_\\\">window</span>.<span class=\\\"hljs-property\\\">parent</span>.<span class=\\\"hljs-title function_\\\">postMessage</span>(<span class=\\\"hljs-title class_\\\">JSON</span>.<span class=\\\"hljs-title function_\\\">stringify</span>(data), <span class=\\\"hljs-string\\\">'http://www.domain1.com'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        }</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    }, <span class=\\\"hljs-literal\\\">false</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h3 style=\\\"margin-left:0px;\\\" id=\\\"article-md-title-12\\\"><a name=\\\"t15\\\"></a><span style=\\\"color:#1c1f21;\\\">9\\u3001WebSocket\\u534F\\u8BAE\\u8DE8\\u57DF</span></h3> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003WebSocket protocol\\u662FHTML5\\u4E00\\u79CD\\u65B0\\u7684\\u534F\\u8BAE\\u3002\\u5B83\\u5B9E\\u73B0\\u4E86\\u6D4F\\u89C8\\u5668\\u4E0E\\u670D\\u52A1\\u5668\\u5168\\u53CC\\u5DE5\\u901A\\u4FE1\\uFF0C\\u540C\\u65F6\\u5141\\u8BB8\\u8DE8\\u57DF\\u901A\\u8BAF\\uFF0C\\u662Fserver push\\u6280\\u672F\\u7684\\u4E00\\u79CD\\u5F88\\u597D\\u7684\\u5B9E\\u73B0\\u3002<br> \\u539F\\u751FWebSocket API\\u4F7F\\u7528\\u8D77\\u6765\\u4E0D\\u592A\\u65B9\\u4FBF\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528Socket.io\\uFF0C\\u5B83\\u5F88\\u597D\\u5730\\u5C01\\u88C5\\u4E86webSocket\\u63A5\\u53E3\\uFF0C\\u63D0\\u4F9B\\u4E86\\u66F4\\u7B80\\u5355\\u3001\\u7075\\u6D3B\\u7684\\u63A5\\u53E3\\uFF0C\\u4E5F\\u5BF9\\u4E0D\\u652F\\u6301webSocket\\u7684\\u6D4F\\u89C8\\u5668\\u63D0\\u4F9B\\u4E86\\u5411\\u4E0B\\u517C\\u5BB9\\u3002<br><br> 1\\uFF09\\u524D\\u7AEF\\u4EE3\\u7801\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-xml\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">div</span>&gt;</span>user input\\uFF1A<span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">input</span> <span class=\\\"hljs-attr\\\">type</span>=<span class=\\\"hljs-string\\\">\\\"text\\\"</span>&gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">div</span>&gt;</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span> <span class=\\\"hljs-attr\\\">src</span>=<span class=\\\"hljs-string\\\">\\\"https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js\\\"</span>&gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span>&gt;</span><span class=\\\"language-javascript\\\"></span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> socket = <span class=\\\"hljs-title function_\\\">io</span>(<span class=\\\"hljs-string\\\">'http://www.domain2.com:8080'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u8FDE\\u63A5\\u6210\\u529F\\u5904\\u7406</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">socket.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'connect'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u76D1\\u542C\\u670D\\u52A1\\u7AEF\\u6D88\\u606F</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    socket.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'message'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">msg</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'data from server: ---&gt; '</span> + msg); </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u76D1\\u542C\\u670D\\u52A1\\u7AEF\\u5173\\u95ED</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    socket.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'disconnect'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) { </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'Server socket has closed.'</span>); </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"17\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"18\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"19\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">document</span>.<span class=\\\"hljs-title function_\\\">getElementsByTagName</span>(<span class=\\\"hljs-string\\\">'input'</span>)[<span class=\\\"hljs-number\\\">0</span>].<span class=\\\"hljs-property\\\">onblur</span> = <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"20\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    socket.<span class=\\\"hljs-title function_\\\">send</span>(<span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">value</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"21\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">};</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"22\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span></div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">2\\uFF09Nodejs socket\\u540E\\u53F0\\uFF1A</span></p> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <pre style=\\\"margin-left:0px;\\\" class=\\\"\\\" name=\\\"code\\\"><span style=\\\"color:#1c1f21;\\\"><code class=\\\"hljs language-javascript\\\"><ol class=\\\"hljs-ln\\\" style=\\\"width:100%\\\"><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"1\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> http = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'http'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"2\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> socket = <span class=\\\"hljs-built_in\\\">require</span>(<span class=\\\"hljs-string\\\">'socket.io'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"3\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"4\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u542Fhttp\\u670D\\u52A1</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"5\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-keyword\\\">var</span> server = http.<span class=\\\"hljs-title function_\\\">createServer</span>(<span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">req, res</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"6\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    res.<span class=\\\"hljs-title function_\\\">writeHead</span>(<span class=\\\"hljs-number\\\">200</span>, {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"7\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-string\\\">'Content-type'</span>: <span class=\\\"hljs-string\\\">'text/html'</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"8\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"9\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    res.<span class=\\\"hljs-title function_\\\">end</span>();</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"10\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"11\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"12\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">server.<span class=\\\"hljs-title function_\\\">listen</span>(<span class=\\\"hljs-string\\\">'8080'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"13\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'Server is running at port 8080...'</span>);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"14\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"15\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"><span class=\\\"hljs-comment\\\">// \\u76D1\\u542Csocket\\u8FDE\\u63A5</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"16\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">socket.<span class=\\\"hljs-title function_\\\">listen</span>(server).<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'connection'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">client</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"17\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u63A5\\u6536\\u4FE1\\u606F</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"18\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    client.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'message'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\">msg</span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"19\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        client.<span class=\\\"hljs-title function_\\\">send</span>(<span class=\\\"hljs-string\\\">'hello\\uFF1A'</span> + msg);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"20\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'data from client: ---&gt; '</span> + msg);</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"21\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"22\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\"> </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"23\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    <span class=\\\"hljs-comment\\\">// \\u65AD\\u5F00\\u5904\\u7406</span></div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"24\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    client.<span class=\\\"hljs-title function_\\\">on</span>(<span class=\\\"hljs-string\\\">'disconnect'</span>, <span class=\\\"hljs-keyword\\\">function</span>(<span class=\\\"hljs-params\\\"></span>) {</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"25\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">        <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(<span class=\\\"hljs-string\\\">'Client socket has closed.'</span>); </div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"26\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">    });</div></div></li><li><div class=\\\"hljs-ln-numbers\\\"><div class=\\\"hljs-ln-line hljs-ln-n\\\" data-line-number=\\\"27\\\"></div></div><div class=\\\"hljs-ln-code\\\"><div class=\\\"hljs-ln-line\\\">});</div></div></li></ol></code><div class=\\\"hljs-button {2}\\\" data-title=\\\"\\u590D\\u5236\\\" data-report-click=\\\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\\\" onclick=\\\"hljs.copyCode(event)\\\"></div></span></pre> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <h2 style=\\\"margin-left:0px;\\\"><a name=\\\"t16\\\"></a><span style=\\\"color:#1c1f21;\\\">\\u5C0F\\u7ED3</span></h2> \\n  </div> \\n  <div style=\\\"margin-left:0px;\\\"> \\n   <p style=\\\"margin-left:0px;\\\"><span style=\\\"color:#1c1f21;\\\">\\u2003\\u2003\\u4EE5\\u4E0A\\u5C31\\u662F9\\u79CD\\u5E38\\u89C1\\u7684\\u8DE8\\u57DF\\u89E3\\u51B3\\u65B9\\u6848\\uFF0Cjsonp\\uFF08\\u53EA\\u652F\\u6301get\\u8BF7\\u6C42\\uFF0C\\u652F\\u6301\\u8001\\u7684IE\\u6D4F\\u89C8\\u5668\\uFF09\\u9002\\u5408\\u52A0\\u8F7D\\u4E0D\\u540C\\u57DF\\u540D\\u7684js\\u3001css\\uFF0Cimg\\u7B49\\u9759\\u6001\\u8D44\\u6E90\\uFF1BCORS\\uFF08\\u652F\\u6301\\u6240\\u6709\\u7C7B\\u578B\\u7684HTTP\\u8BF7\\u6C42\\uFF0C\\u4F46\\u6D4F\\u89C8\\u5668IE10\\u4EE5\\u4E0B\\u4E0D\\u652F\\u6301\\uFF09\\u9002\\u5408\\u505Aajax\\u5404\\u79CD\\u8DE8\\u57DF\\u8BF7\\u6C42\\uFF1BNginx\\u4EE3\\u7406\\u8DE8\\u57DF\\u548Cnodejs\\u4E2D\\u95F4\\u4EF6\\u8DE8\\u57DF\\u539F\\u7406\\u90FD\\u76F8\\u4F3C\\uFF0C\\u90FD\\u662F\\u642D\\u5EFA\\u4E00\\u4E2A\\u670D\\u52A1\\u5668\\uFF0C\\u76F4\\u63A5\\u5728\\u670D\\u52A1\\u5668\\u7AEF\\u8BF7\\u6C42HTTP\\u63A5\\u53E3\\uFF0C\\u8FD9\\u9002\\u5408\\u524D\\u540E\\u7AEF\\u5206\\u79BB\\u7684\\u524D\\u7AEF\\u9879\\u76EE\\u8C03\\u540E\\u7AEF\\u63A5\\u53E3\\u3002document.domain+iframe\\u9002\\u5408\\u4E3B\\u57DF\\u540D\\u76F8\\u540C\\uFF0C\\u5B50\\u57DF\\u540D\\u4E0D\\u540C\\u7684\\u8DE8\\u57DF\\u8BF7\\u6C42\\u3002postMessage\\u3001websocket\\u90FD\\u662FHTML5\\u65B0\\u7279\\u6027\\uFF0C\\u517C\\u5BB9\\u6027\\u4E0D\\u662F\\u5F88\\u597D\\uFF0C\\u53EA\\u9002\\u7528\\u4E8E\\u4E3B\\u6D41\\u6D4F\\u89C8\\u5668\\u548CIE10+\\u3002<br><br> \\u2003\\u2003\\u8FD9\\u4E48\\u591A\\u7684\\u8DE8\\u57DF\\u65B9\\u6848\\uFF0C\\u6CA1\\u6709\\u6700\\u597D\\uFF0C\\u53EA\\u6709\\u6700\\u5408\\u9002\\u7684\\uFF0C\\u6839\\u636E\\u5177\\u4F53\\u7684\\u4F7F\\u7528\\u573A\\u666F\\u9009\\u62E9\\u8DE8\\u57DF\\u65B9\\u6848\\u3002\\u5E0C\\u671B\\u8FD9\\u7BC7\\u535A\\u6587\\u80FD\\u5E26\\u7ED9\\u5927\\u5BB6\\u4E00\\u70B9\\u5E2E\\u52A9~~</span></p> \\n  </div> \\n </div> \\n <div style=\\\"margin-left:0px;\\\"> \\n  <div style=\\\"margin-left:0px;\\\">\\n   &nbsp;\\n  </div> \\n </div> \\n</div>\\n                </div><div data-report-view=\\\"{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://blog.csdn.net/mydriverc2/article/details/113948017&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}\\\"><div></div></div>\\n        </div>\"\n  }\n});\nMock.mock(\"/api/com\", \"post\", {\n  code: 0,\n  msg: \"\",\n  data: {\n    id: \"@guid\",\n    nickName: \"@cname\",\n    content: \"@cparagraph(1 ,10)\",\n    createDate: Date.now(),\n    \"avatar|1\": [\"https://avatars.devrant.com/v-37_c-3_b-5_g-m_9-1_1-2_16-3_3-2_8-1_7-1_5-1_12-2_6-2_10-1_2-10_22-1_15-3_4-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-2_1-1_16-9_3-6_8-4_7-4_5-4_12-1_6-7_10-5_2-59_22-1_11-2_18-4_19-3_4-4_20-13_21-5.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-6_g-m_9-1_1-1_16-6_3-6_8-2_7-2_5-1_12-1_6-1_10-3_2-14_22-8_18-2_19-2_4-1_20-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-4_g-m_9-1_1-2_16-12_3-1_8-1_7-1_5-1_12-2_6-15_2-20_22-7_15-10_4-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-7_g-m_9-1_1-7_16-1_3-1_8-1_7-1_5-1_12-7_6-10_2-31_22-6_15-3_18-1_19-1_4-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-1_1-6_16-1_3-1_8-1_7-1_5-1_12-6_6-10_10-1_2-3_22-6_19-1_4-1.jpg\"]\n  }\n});\nMock.mock(/^\\/api\\/comment\\/?(\\?.+)?$/, \"get\", function (options) {\n  var query = qs.parse(options.url);\n  return Mock.mock({\n    code: 0,\n    msg: \"\",\n    data: _defineProperty({\n      total: 52\n    }, \"rows|\".concat(query.limit || 10), [{\n      id: \"@guid\",\n      nickName: \"@cname\",\n      content: \"@cparagraph(1 ,10)\",\n      createDate: Date.now(),\n      \"avatar|1\": [\"https://avatars.devrant.com/v-37_c-3_b-5_g-m_9-1_1-2_16-3_3-2_8-1_7-1_5-1_12-2_6-2_10-1_2-10_22-1_15-3_4-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-2_1-1_16-9_3-6_8-4_7-4_5-4_12-1_6-7_10-5_2-59_22-1_11-2_18-4_19-3_4-4_20-13_21-5.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-6_g-m_9-1_1-1_16-6_3-6_8-2_7-2_5-1_12-1_6-1_10-3_2-14_22-8_18-2_19-2_4-1_20-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-4_g-m_9-1_1-2_16-12_3-1_8-1_7-1_5-1_12-2_6-15_2-20_22-7_15-10_4-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-7_g-m_9-1_1-7_16-1_3-1_8-1_7-1_5-1_12-7_6-10_2-31_22-6_15-3_18-1_19-1_4-1.jpg\", \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-1_1-6_16-1_3-1_8-1_7-1_5-1_12-6_6-10_10-1_2-3_22-6_19-1_4-1.jpg\"]\n    }])\n  });\n});","map":{"version":3,"names":["Mock","qs","mock","code","msg","name","options","query","parse","url","data","limit","id","title","description","category","createDate","toc","anchor","childrenList","Random","image","htmlContent","nickName","content","Date","now","total"],"sources":["/Users/linwinwin/Desktop/mysit2/mysite-client/src/mock/blog.js"],"sourcesContent":["import Mock from 'mockjs';\nimport qs from 'qs'\n// 利用 mock 模拟 getBlogs 和 getBlogTypes 请求服务器返回的数据\nMock.mock(\"/api/blogtype\", \"get\", {\n    code: 0,\n    msg: \"\",\n    \"data|10-20\": [{ //随机在 10 到 20 生成\n        \"id|+1\": 1, //自增1\n        name: \"分类@id\",\n        \"articleCount|0-300\": 0, // 随机生成数据\n        \"order|+1\": 1, //自增 1 \n    }, ]\n});\n\nMock.mock(/^\\/api\\/blog(\\?.+)?$/, \"get\", function (options) {\n    const query = qs.parse(options.url);\n    return Mock.mock({\n        code: 0,\n        msg: \"\",\n        data: {\n            \"total|2000-3000\": 0,\n            [`rows|${query.limit || 10 }`]: [{\n                id: \"@guid\",\n                title: \"@ctitle\",\n                description: \"@cparagraph(1,10)\",\n                category: {\n                    \"id|1-10\": 0,\n                    name: \"分类@id\",\n                },\n                \"scanCount|0-3000\": 0,\n                \"commentCount|0-3000\": 0,\n                // \"thumb|1\": [Mock.Random.image(\"300x250\", \"#000\", \"#fff\", \"Random Image\"), null],\n                \"thumb|1\": [\"@image(300x250, #000, @color, @natural)\"],\n                createDate: `@date('T')`\n            }]\n        }\n    })\n})\n\nMock.mock(/^\\/api\\/blog\\/[^/]+$/, \"get\", {\n    code: 0,\n    msg: \"\",\n    data: {\n        id: \"@guid\",\n        title: \"前端常见跨域解决方案（全）\",\n        category: {\n            \"id|1-10\": 0,\n            name: \"分类@id\",\n        },\n        description: \"@cparagraph(1, 10)\",\n        \"scanNumber|0-10000\": 0,\n        \"commentNumber|0-100\": 0,\n        createDate: `@date('T')`,\n        toc: [{\n                name: \"什么是跨域\",\n                anchor: 'article-md-title-1',\n            },\n            {\n                name: \"常见的跨域场景\",\n                anchor: 'article-md-title-2'\n            },\n            {\n                name: \"9种跨域解决方法\",\n                anchor: 'article-md-title-3',\n                childrenList: [{\n                        name: \"JSON跨域\",\n                        anchor: \"article-md-title-4\",\n                    },\n                    {\n                        name: \"跨域资源共享(CORS)\",\n                        anchor: \"article-md-title-5\"\n                    },\n                    {\n                        name: \"nginx代理跨域\",\n                        anchor: \"article-md-title-6\"\n                    },\n                    {\n                        name: \"nodejs中间件代理跨域\",\n                        anchor: \"article-md-title-7\"\n                    },\n                    {\n                        name: \"document.domain+iframe跨域\",\n                        anchor: \"article-md-title-8\"\n                    },\n                    {\n                        name: \"Location.hash+iframe跨域\",\n                        anchor: \"article-md-title-9\"\n                    },\n                    {\n                        name: \"window.name+iframe跨域\",\n                        anchor: \"article-md-title-10\"\n                    },\n                    {\n                        name: \"postMessage跨域\",\n                        anchor: \"article-md-title-11\"\n                    },\n                    {\n                        name: \"WebSocket协议跨域\",\n                        anchor: \"article-md-title-12\"\n                    }\n                ]\n            },\n\n        ],\n        \"thumb|1\": [Mock.Random.image(\"300x250\", \"#000\", \"#fff\", \"Random Image\"), null],\n        htmlContent: `<div id=\"article_content\" class=\"article_content clearfix\">\n       \n                <div id=\"content_views\" class=\"htmledit_views\">\n<div style=\"margin-left:0px;\"> \n <div style=\"margin-left:0px;\"> \n  <div style=\"margin-left:0px;\"> \n   <h2 style=\"margin-left:0px;\" id =\"article-md-title-1\"><a name=\"t0\"></a><span style=\"color:#1c1f21;\">一、什么是跨域？</span></h2> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  在前端领域中，跨域是指浏览器允许向服务器发送跨域请求，从而克服Ajax只能<strong>同源</strong>使用的限制。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\"><a name=\"t1\"></a><span style=\"color:#1c1f21;\">什么是同源策略？</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  <strong>同源策略</strong>是一种约定，由Netscape公司1995年引入浏览器，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，浏览器很容易受到XSS、CSFR等攻击。所谓同源是指\"协议+域名+端口\"三者相同，即便两个不同的域名指向同一个ip地址，也非同源。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  同源策略限制以下几种行为：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">Cookie、LocalStorage 和 IndexDB 无法读取</span></li><li><span style=\"color:#1c1f21;\">DOM和JS对象无法获得</span></li><li><span style=\"color:#1c1f21;\">AJAX 请求不能发送</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h2 style=\"margin-left:0px;\" id= \"article-md-title-2\"><a name=\"t2\"></a><span style=\"color:#1c1f21;\">二、常见的跨域场景</span></h2> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <div style=\"margin-left:0px;\"> \n    <div class=\"table-box\"><table border=\"1\" cellspacing=\"0\"><thead><tr><th style=\"border-color:#bbbbbb #dddddd #dddddd;text-align:left;\"><span style=\"color:#1c1f21;\">URL</span></th><th style=\"border-color:#bbbbbb #dddddd #dddddd;text-align:left;\"><span style=\"color:#1c1f21;\">说明</span></th><th style=\"border-color:#bbbbbb #dddddd #dddddd;text-align:left;\"><span style=\"color:#1c1f21;\">是否允许通信</span></th></tr></thead><tbody><tr><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\"><a href=\"http://www.domain.com/\">http://www.domain.com/</a><span style=\"color:#ff0000;\">a.js</span><br><a href=\"http://www.domain.com/\">http://www.domain.com/</a><span style=\"color:#ff0000;\">b.js</span><br><a href=\"http://www.domain.com/\">http://www.domain.com/</a><span style=\"color:#ff0000;\">lab/c.js</span></span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">同一域名，不同文件或路径</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">允许</span></td></tr><tr><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\"><a href=\"http://www.domain.com/\">http://www.domain.com</a>:<span style=\"color:#ff0000;\">8000</span>/a.js<br><a href=\"http://www.domain.com/b.js\">http://www.domain.com/b.js</a></span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">同一域名，不同端口</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">不允许</span></td></tr><tr><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\"><span style=\"color:#ff0000;\">http</span>://www.domain.com/a.js<br><span style=\"color:#ff0000;\">https</span>://www.domain.com/b.js</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">同一域名，不同协议</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">不允许</span></td></tr><tr><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">http://<span style=\"color:#ff0000;\">www.domain.com</span>/a.js<br> http://<span style=\"color:#ff0000;\">192.168.4.12</span>/b.js</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">域名和域名对应相同ip</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">不允许</span></td></tr><tr><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">http://<span style=\"color:#ff0000;\">www.domain.com</span>/a.js<br> http://<span style=\"color:#ff0000;\">x.domain.com</span>/b.js<br> http://<span style=\"color:#ff0000;\">domain.com</span>/c.js</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">主域相同，子域不同</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">不允许</span></td></tr><tr><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">http://<span style=\"color:#ff0000;\">www.domain1.com</span>/a.js<br> http://<span style=\"color:#ff0000;\">www.domain2.com</span>/b.js</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">不同域名</span></td><td style=\"border-color:#dddddd;\"><span style=\"color:#1c1f21;\">不允许</span></td></tr></tbody></table></div>\n   </div> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h2 style=\"margin-left:0px;\" id=\"article-md-title-3\"><a name=\"t3\"></a><span style=\"color:#1c1f21;\">三、9种跨域解决方案</span></h2> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-4\"><a name=\"t4\"></a><span style=\"color:#1c1f21;\">1、JSONP跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  <strong>jsonp</strong>的原理就是利用<code>&lt;script&gt;</code>标签没有跨域限制，通过<code>&lt;script&gt;</code>标签src属性，发送带有callback参数的GET请求，服务端将接口返回数据拼凑到callback函数中，返回给浏览器，浏览器解析执行，从而前端拿到callback函数返回的数据。<br><br> 1）原生JS实现：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:816px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> script = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">'script'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    script.<span class=\"hljs-property\">type</span> = <span class=\"hljs-string\">'text/javascript'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 传参一个回调函数名给后端，方便后端返回时执行这个在前端定义的回调函数</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    script.<span class=\"hljs-property\">src</span> = <span class=\"hljs-string\">'http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">head</span>.<span class=\"hljs-title function_\">appendChild</span>(script);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 回调执行函数</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">handleCallback</span>(<span class=\"hljs-params\">res</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-title function_\">alert</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(res));</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">服务端返回如下（返回时即执行全局函数）：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><span class=\"hljs-title function_\">handleCallback</span>({<span class=\"hljs-string\">\"success\"</span>: <span class=\"hljs-literal\">true</span>, <span class=\"hljs-string\">\"user\"</span>: <span class=\"hljs-string\">\"admin\"</span>})\n</code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">2）jquery Ajax实现：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-rust\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">$.<span class=\"hljs-title function_ invoke__\">ajax</span>({</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    url: <span class=\"hljs-symbol\">'http</span>:<span class=\"hljs-comment\">//www.domain2.com:8080/login',</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">type</span>: <span class=\"hljs-symbol\">'get</span>',</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    dataType: <span class=\"hljs-symbol\">'jsonp</span>',  <span class=\"hljs-comment\">// 请求方式为jsonp</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    jsonpCallback: <span class=\"hljs-string\">\"handleCallback\"</span>,  <span class=\"hljs-comment\">// 自定义回调函数名</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    data: {}</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">3）Vue axios实现：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">$http</span> = axios;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">$http</span>.<span class=\"hljs-title function_\">jsonp</span>(<span class=\"hljs-string\">'http://www.domain2.com:8080/login'</span>, {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-attr\">params</span>: {},</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-attr\">jsonp</span>: <span class=\"hljs-string\">'handleCallback'</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">}).<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">res</span>) =&gt;</span> {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(res); </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">})</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">后端node.js代码：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> querystring = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'querystring'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'http'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> server = http.<span class=\"hljs-title function_\">createServer</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">server.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'request'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">req, res</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> params = querystring.<span class=\"hljs-title function_\">parse</span>(req.<span class=\"hljs-property\">url</span>.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">'?'</span>)[<span class=\"hljs-number\">1</span>]);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> fn = params.<span class=\"hljs-property\">callback</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// jsonp返回设置</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    res.<span class=\"hljs-title function_\">writeHead</span>(<span class=\"hljs-number\">200</span>, { <span class=\"hljs-string\">'Content-Type'</span>: <span class=\"hljs-string\">'text/javascript'</span> });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    res.<span class=\"hljs-title function_\">write</span>(fn + <span class=\"hljs-string\">'('</span> + <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(params) + <span class=\"hljs-string\">')'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    res.<span class=\"hljs-title function_\">end</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">server.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-string\">'8080'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"17\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Server is running at port 8080...'</span>);</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <blockquote> \n    <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">jsonp的缺点：只能发送get一种请求。</span></p> \n   </blockquote> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-5\"><a name=\"t5\"></a><span style=\"color:#1c1f21;\">2、跨域资源共享（CORS）</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  <strong>CORS</strong>是一个W3C标准，全称是\"跨域资源共享\"（Cross-origin resource sharing）。<br> 它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。<br> CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。<br><br>   浏览器将CORS跨域请求分为简单请求和非简单请求。<br><br>   只要同时满足一下两个条件，就属于简单请求<br><br> (1)使用下列方法之一：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">head</span></li><li><span style=\"color:#1c1f21;\">get</span></li><li><span style=\"color:#1c1f21;\">post</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">(2)请求的Heder是</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">Accept</span></li><li><span style=\"color:#1c1f21;\">Accept-Language</span></li><li><span style=\"color:#1c1f21;\">Content-Language</span></li><li><span style=\"color:#1c1f21;\">Content-Type: 只限于三个值：application/x-www-form-urlencoded、multipart/form-data、text/plain</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">不同时满足上面的两个条件，就属于非简单请求。浏览器对这两种的处理，是不一样的。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" ><a name=\"t6\"></a><span style=\"color:#1c1f21;\">简单请求</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  对于简单请求，浏览器直接发出CORS请求。具体来说，就是在头信息之中，增加一个Origin字段。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-sql\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">GET</span> <span class=\"hljs-operator\">/</span>cors HTTP<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.1</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Origin: http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>api.bob.com</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Host: api.alice.com</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Accept<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">Language</span>: en<span class=\"hljs-operator\">-</span>US</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Connection: keep<span class=\"hljs-operator\">-</span>alive</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">User</span><span class=\"hljs-operator\">-</span>Agent: Mozilla<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">5.0</span>...</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  上面的头信息中，Origin字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p><span style=\"color:#1c1f21;\">CORS请求设置的响应头字段，都以 Access-Control-开头:</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><strong>1）Access-Control-Allow-Origin</strong>：必选<br><br>   它的值要么是请求时Origin字段的值，要么是一个*，表示接受任意域名的请求。<br><br><strong>2）Access-Control-Allow-Credentials</strong>：可选<br><br>   它的值是一个布尔值，表示是否允许发送Cookie。默认情况下，Cookie不包括在CORS请求之中。设为true，即表示服务器明确许可，Cookie可以包含在请求中，一起发给服务器。这个值也只能设为true，如果服务器不要浏览器发送Cookie，删除该字段即可。<br><br><strong>3）Access-Control-Expose-Headers</strong>：可选<br><br>   CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。上面的例子指定，getResponseHeader(‘FooBar’)可以返回FooBar字段的值。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\"><a name=\"t7\"></a><span style=\"color:#1c1f21;\">非简单请求</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  非简单请求是那种对服务器有特殊要求的请求，比如请求方法是PUT或DELETE，或者Content-Type字段的类型是application/json。非简单请求的CORS请求，会在正式通信之前，增加一次HTTP查询请求，称为\"预检\"请求（preflight）。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p><span style=\"color:#1c1f21;\">预检请求</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  预检\"请求用的请求方法是OPTIONS，表示这个请求是用来询问的。请求头信息里面，关键字段是Origin，表示请求来自哪个源。除了Origin字段，\"预检\"请求的头信息包括两个特殊字段。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-sql\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">OPTIONS <span class=\"hljs-operator\">/</span>cors HTTP<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">1.1</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Origin: http:<span class=\"hljs-operator\">/</span><span class=\"hljs-operator\">/</span>api.bob.com</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Access<span class=\"hljs-operator\">-</span>Control<span class=\"hljs-operator\">-</span>Request<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">Method</span>: PUT</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Access<span class=\"hljs-operator\">-</span>Control<span class=\"hljs-operator\">-</span>Request<span class=\"hljs-operator\">-</span>Headers: X<span class=\"hljs-operator\">-</span>Custom<span class=\"hljs-operator\">-</span>Header</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Host: api.alice.com</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Accept<span class=\"hljs-operator\">-</span><span class=\"hljs-keyword\">Language</span>: en<span class=\"hljs-operator\">-</span>US</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">Connection: keep<span class=\"hljs-operator\">-</span>alive</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">User</span><span class=\"hljs-operator\">-</span>Agent: Mozilla<span class=\"hljs-operator\">/</span><span class=\"hljs-number\">5.0</span>..</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><strong>1）Access-Control-Request-Method</strong>：必选<br><br>   用来列出浏览器的CORS请求会用到哪些HTTP方法，上例是PUT。<br><br><strong>2）Access-Control-Request-Headers</strong>：可选<br><br>   该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，上例是X-Custom-Header。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p><span style=\"color:#1c1f21;\">预检请求的回应</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  服务器收到\"预检\"请求以后，检查了Origin、Access-Control-Request-Method和Access-Control-Request-Headers字段以后，确认允许跨源请求，就可以做出回应。<br><br>   HTTP回应中，除了关键的是Access-Control-Allow-Origin字段，其他CORS相关字段如下：<br><br><strong>1）Access-Control-Allow-Methods</strong>：必选<br><br>   它的值是逗号分隔的一个字符串，表明服务器支持的所有跨域请求的方法。注意，返回的是所有支持的方法，而不单是浏览器请求的那个方法。这是为了避免多次\"预检\"请求。<br><br><strong>2）Access-Control-Allow-Headers</strong><br><br>   如果浏览器请求包括Access-Control-Request-Headers字段，则Access-Control-Allow-Headers字段是必需的。它也是一个逗号分隔的字符串，表明服务器支持的所有头信息字段，不限于浏览器在\"预检\"中请求的字段。<br><br><strong>3）Access-Control-Allow-Credentials</strong>：可选<br><br>   该字段与简单请求时的含义相同。<br><br><strong>4）Access-Control-Max-Age</strong>：可选<br><br>   用来指定本次预检请求的有效期，单位为秒。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\"><a name=\"t8\"></a><span style=\"color:#1c1f21;\">CORS跨域示例</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><strong>1）前端设置</strong>：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">原生ajax：</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> xhr = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">XMLHttpRequest</span>(); <span class=\"hljs-comment\">// IE8/9需用window.XDomainRequest兼容</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 前端设置是否带cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-property\">withCredentials</span> = <span class=\"hljs-literal\">true</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-title function_\">open</span>(<span class=\"hljs-string\">'post'</span>, <span class=\"hljs-string\">'http://www.domain2.com:8080/login'</span>, <span class=\"hljs-literal\">true</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-title function_\">setRequestHeader</span>(<span class=\"hljs-string\">'Content-Type'</span>, <span class=\"hljs-string\">'application/x-www-form-urlencoded'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">'user=admin'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-property\">onreadystatechange</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">if</span> (xhr.<span class=\"hljs-property\">readyState</span> == <span class=\"hljs-number\">4</span> &amp;&amp; xhr.<span class=\"hljs-property\">status</span> == <span class=\"hljs-number\">200</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-title function_\">alert</span>(xhr.<span class=\"hljs-property\">responseText</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">};</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">jquery ajax：</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">$.<span class=\"hljs-title function_\">ajax</span>({</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    ...</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">   <span class=\"hljs-attr\">xhrFields</span>: {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">       <span class=\"hljs-attr\">withCredentials</span>: <span class=\"hljs-literal\">true</span>    <span class=\"hljs-comment\">// 前端设置是否带cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">   },</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">   <span class=\"hljs-attr\">crossDomain</span>: <span class=\"hljs-literal\">true</span>,   <span class=\"hljs-comment\">// 会让请求头中包含跨域的额外信息，但不会含cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    ...</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><strong>2）服务端设置</strong>：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">nodejs代码</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:1018px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'http'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> server = http.<span class=\"hljs-title function_\">createServer</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> qs = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'querystring'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">server.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'request'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">req, res</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> postData = <span class=\"hljs-string\">''</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 数据块接收中</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    req.<span class=\"hljs-title function_\">addListener</span>(<span class=\"hljs-string\">'data'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">chunk</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        postData += chunk;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 数据接收完毕</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    req.<span class=\"hljs-title function_\">addListener</span>(<span class=\"hljs-string\">'end'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        postData = qs.<span class=\"hljs-title function_\">parse</span>(postData);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"17\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-comment\">// 跨域后台设置</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"18\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        res.<span class=\"hljs-title function_\">writeHead</span>(<span class=\"hljs-number\">200</span>, {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"19\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-string\">'Access-Control-Allow-Credentials'</span>: <span class=\"hljs-string\">'true'</span>,     <span class=\"hljs-comment\">// 后端允许发送Cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"20\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-string\">'Access-Control-Allow-Origin'</span>: <span class=\"hljs-string\">'http://www.domain1.com'</span>,    <span class=\"hljs-comment\">// 允许访问的域（协议+域名+端口）</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"21\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-comment\"><span class=\"hljs-comment\">/* </span></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"22\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">             * 此处设置的cookie还是domain2的而非domain1，因为后端也不能跨域写cookie(nginx反向代理可以实现)，</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"23\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">             * 但只要domain2中写入一次cookie认证，后面的跨域接口都能从domain2中获取cookie，从而实现所有的接口都能跨域访问</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"24\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">             */</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"25\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-string\">'Set-Cookie'</span>: <span class=\"hljs-string\">'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly'</span>  <span class=\"hljs-comment\">// HttpOnly的作用是让js无法读取cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"26\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"27\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"28\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        res.<span class=\"hljs-title function_\">write</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(postData));</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"29\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        res.<span class=\"hljs-title function_\">end</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"30\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"31\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"32\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"33\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">server.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-string\">'8080'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"34\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Server is running at port 8080...'</span>);</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\"id=\"article-md-title-6\"><a name=\"t9\"></a><span style=\"color:#1c1f21;\">3、nginx代理跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  nginx代理跨域，实质和CORS跨域原理一样，通过配置文件设置请求响应头<span style=\"color:#ff502c;\">Access-Control-Allow-Origin</span>…等字段。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p><span style=\"color:#1c1f21;\">1）nginx配置解决iconfont跨域</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  浏览器跨域访问js、css、img等常规静态资源被同源策略许可，但iconfont字体文件(eot|otf|ttf|woff|svg)例外，此时可在nginx的静态资源服务器中加入以下配置。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-undefined\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">location / {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">  add_header Access-Control-Allow-Origin *;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">}</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p><span style=\"color:#1c1f21;\">2）nginx反向代理接口跨域</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <blockquote> \n    <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">跨域问题：同源策略仅是针对浏览器的安全策略。服务器端调用HTTP接口只是使用HTTP协议，不需要同源策略，也就不存在跨域问题。</span></p> \n   </blockquote> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">实现思路：通过Nginx配置一个代理服务器域名与domain1相同，端口不同）做跳板机，反向代理访问domain2接口，并且可以顺便修改cookie中domain信息，方便当前域cookie写入，实现跨域访问。<br><br> nginx具体配置：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-perl\"><ol class=\"hljs-ln\" style=\"width:940px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">#proxy服务器</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">server {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">listen</span>       <span class=\"hljs-number\">81</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    server_name  www.domain1.com;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    location / {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        proxy_pass   http:<span class=\"hljs-regexp\">//</span>www.domain2.com:<span class=\"hljs-number\">8080</span>;  <span class=\"hljs-comment\">#反向代理</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        proxy_cookie_domain www.domain2.com www.domain1.com; <span class=\"hljs-comment\">#修改cookie里域名</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-keyword\">index</span>  index.html index.htm;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-comment\"># 当用webpack-dev-server等中间件代理接口访问nignx时，此时无浏览器参与，故没有同源限制，下面的跨域配置可不启用</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        add_header Access-Control-Allow-Origin http:<span class=\"hljs-regexp\">//</span>www.domain1.com;  <span class=\"hljs-comment\">#当前端只跨域不带cookie时，可为*</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        add_header Access-Control-Allow-Credentials true;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">}</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-7\"><a name=\"t10\"></a><span style=\"color:#1c1f21;\">4、nodejs中间件代理跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  node中间件实现跨域代理，原理大致与nginx相同，都是通过启一个代理服务器，实现数据的转发，也可以通过设置cookieDomainRewrite参数修改响应头中cookie中域名，实现当前域的cookie写入，方便接口登录认证。<br><br><strong>1）非vue框架的跨域</strong><br><br>   使用node + express + http-proxy-middleware搭建一个proxy服务器。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">前端代码：</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> xhr = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">XMLHttpRequest</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 前端开关：浏览器是否读写cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-property\">withCredentials</span> = <span class=\"hljs-literal\">true</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 访问http-proxy-middleware代理服务器</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-title function_\">open</span>(<span class=\"hljs-string\">'get'</span>, <span class=\"hljs-string\">'http://www.domain1.com:3000/login?user=admin'</span>, <span class=\"hljs-literal\">true</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">xhr.<span class=\"hljs-title function_\">send</span>();</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">中间件服务器代码：</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'express'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> proxy = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'http-proxy-middleware'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">'/'</span>, <span class=\"hljs-title function_\">proxy</span>({</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 代理跨域目标接口</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-attr\">target</span>: <span class=\"hljs-string\">'http://www.domain2.com:8080'</span>,</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-attr\">changeOrigin</span>: <span class=\"hljs-literal\">true</span>,</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 修改响应头信息，实现跨域并允许带cookie</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-attr\">onProxyRes</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">proxyRes, req, res</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        res.<span class=\"hljs-title function_\">header</span>(<span class=\"hljs-string\">'Access-Control-Allow-Origin'</span>, <span class=\"hljs-string\">'http://www.domain1.com'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        res.<span class=\"hljs-title function_\">header</span>(<span class=\"hljs-string\">'Access-Control-Allow-Credentials'</span>, <span class=\"hljs-string\">'true'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    },</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 修改响应信息中的cookie域名</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"17\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-attr\">cookieDomainRewrite</span>: <span class=\"hljs-string\">'www.domain1.com'</span>  <span class=\"hljs-comment\">// 可以为false，表示不修改</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"18\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">}));</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"19\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"20\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">app.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"21\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Proxy server is listen at port 3000...'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"22\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\" data-report-view=\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><strong>2）vue框架的跨域</strong><br><br>   node + vue + webpack + webpack-dev-server搭建的项目，跨域请求接口，直接修改webpack.config.js配置。开发环境下，vue渲染服务和接口代理服务都是webpack-dev-server同一个，所以页面与代理接口之间不再跨域。<br><br> webpack.config.js部分配置：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-java\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">module</span>.<span class=\"hljs-keyword\">exports</span> = {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    entry: {},</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">module</span>: {},</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    ...</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    devServer: {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        historyApiFallback: <span class=\"hljs-literal\">true</span>,</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        proxy: [{</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            context: <span class=\"hljs-string\">'/login'</span>,</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            target: <span class=\"hljs-string\">'http://www.domain2.com:8080'</span>,  <span class=\"hljs-comment\">// 代理跨域目标接口</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            changeOrigin: <span class=\"hljs-literal\">true</span>,</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            secure: <span class=\"hljs-literal\">false</span>,  <span class=\"hljs-comment\">// 当代理某些https服务报错时用</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            cookieDomainRewrite: <span class=\"hljs-string\">'www.domain1.com'</span>  <span class=\"hljs-comment\">// 可以为false，表示不修改</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        }],</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        noInfo: <span class=\"hljs-literal\">true</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">}</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\" data-report-view=\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-8\"><a name=\"t11\"></a><span style=\"color:#1c1f21;\">5、document.domain + iframe跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  此方案仅限主域相同，子域不同的跨域应用场景。实现原理：两个页面都通过js强制设置document.domain为基础主域，就实现了同域。<br><br> 1）父窗口：(<a href=\"http://www.domain.com/a.html\">http://www.domain.com/a.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">iframe</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"iframe\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"http://child.domain.com/b.html\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">iframe</span>&gt;</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">domain</span> = <span class=\"hljs-string\">'domain.com'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> user = <span class=\"hljs-string\">'admin'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">1）子窗口：(<a href=\"http://child.domain.com/a.html\">http://child.domain.com/a.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">domain</span> = <span class=\"hljs-string\">'domain.com'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 获取父窗口中变量</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'get js data from parent ---&gt; '</span> + <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">parent</span>.<span class=\"hljs-property\">user</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-9\"><a name=\"t12\"></a><span style=\"color:#1c1f21;\">6、location.hash + iframe跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  实现原理： a欲与b跨域相互通信，通过中间页c来实现。 三个页面，不同域之间利用iframe的location.hash传值，相同域之间直接js访问来通信。<br><br>   具体实现：A域：a.html -&gt; B域：b.html -&gt; A域：c.html，a与b不同域只能通过hash值单向通信，b与c也不同域也只能单向通信，但c与a同域，所以c可通过parent.parent访问a页面所有对象。<br><br> 1）a.html：(<a href=\"http://www.domain1.com/a.html\">http://www.domain1.com/a.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:807px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">iframe</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"iframe\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"http://www.domain2.com/b.html\"</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">\"display:none;\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">iframe</span>&gt;</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> iframe = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">'iframe'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 向b.html传hash值</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-built_in\">setTimeout</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        iframe.<span class=\"hljs-property\">src</span> = iframe.<span class=\"hljs-property\">src</span> + <span class=\"hljs-string\">'#user=admin'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }, <span class=\"hljs-number\">1000</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 开放给同域c.html的回调方法</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">onCallback</span>(<span class=\"hljs-params\">res</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-title function_\">alert</span>(<span class=\"hljs-string\">'data from c.html ---&gt; '</span> + res);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">2）b.html：(<a href=\"http://www.domain2.com/b.html\">http://www.domain2.com/b.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:807px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">iframe</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"iframe\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"http://www.domain1.com/c.html\"</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">\"display:none;\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">iframe</span>&gt;</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> iframe = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">'iframe'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 监听a.html传来的hash值，再传给c.html</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onhashchange</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        iframe.<span class=\"hljs-property\">src</span> = iframe.<span class=\"hljs-property\">src</span> + location.<span class=\"hljs-property\">hash</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    };</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">3）c.html：(<a href=\"http://www.domain1.com/c.html\">http://www.domain1.com/c.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:824px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 监听b.html传来的hash值</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onhashchange</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-comment\">// 再通过操作同域a.html的js回调，将结果传回</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">parent</span>.<span class=\"hljs-property\">parent</span>.<span class=\"hljs-title function_\">onCallback</span>(<span class=\"hljs-string\">'hello: '</span> + location.<span class=\"hljs-property\">hash</span>.<span class=\"hljs-title function_\">replace</span>(<span class=\"hljs-string\">'#user='</span>, <span class=\"hljs-string\">''</span>));</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    };</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-10\"><a name=\"t13\"></a><span style=\"color:#1c1f21;\">7、window.name + iframe跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  window.name属性的独特之处：name值在不同的页面（甚至不同域名）加载后依旧存在，并且可以支持非常长的 name 值（2MB）。<br><br> 1）a.html：(<a href=\"http://www.domain1.com/a.html\">http://www.domain1.com/a.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> proxy = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">url, callback</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> state = <span class=\"hljs-number\">0</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> iframe = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">'iframe'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 加载跨域页面</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    iframe.<span class=\"hljs-property\">src</span> = url;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// onload事件会触发2次，第1次加载跨域页，并留存数据于window.name</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    iframe.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-keyword\">if</span> (state === <span class=\"hljs-number\">1</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-comment\">// 第2次onload(同域proxy页)成功后，读取同域window.name中数据</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-title function_\">callback</span>(iframe.<span class=\"hljs-property\">contentWindow</span>.<span class=\"hljs-property\">name</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-title function_\">destoryFrame</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (state === <span class=\"hljs-number\">0</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-comment\">// 第1次onload(跨域页)成功后，切换到同域代理页面</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"17\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            iframe.<span class=\"hljs-property\">contentWindow</span>.<span class=\"hljs-property\">location</span> = <span class=\"hljs-string\">'http://www.domain1.com/proxy.html'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"18\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            state = <span class=\"hljs-number\">1</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"19\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"20\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    };</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"21\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"22\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">body</span>.<span class=\"hljs-title function_\">appendChild</span>(iframe);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"23\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"24\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 获取数据以后销毁这个iframe，释放内存；这也保证了安全（不被其他域frame js访问）</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"25\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">destoryFrame</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"26\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        iframe.<span class=\"hljs-property\">contentWindow</span>.<span class=\"hljs-property\">document</span>.<span class=\"hljs-title function_\">write</span>(<span class=\"hljs-string\">''</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"27\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        iframe.<span class=\"hljs-property\">contentWindow</span>.<span class=\"hljs-title function_\">close</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"28\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">body</span>.<span class=\"hljs-title function_\">removeChild</span>(iframe);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"29\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"30\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">};</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"31\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"32\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 请求跨域b页面数据</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"33\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-title function_\">proxy</span>(<span class=\"hljs-string\">'http://www.domain2.com/b.html'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">data</span>){</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"34\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-title function_\">alert</span>(data);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"35\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\" data-report-view=\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">2）proxy.html：(<a href=\"http://www.domain1.com/proxy.html\">http://www.domain1.com/proxy.html</a>)<br><br>   中间代理页，与a.html同域，内容为空即可。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">3）b.html：(<a href=\"http://www.domain2.com/b.html\">http://www.domain2.com/b.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">name</span> = <span class=\"hljs-string\">'This is domain2 data!'</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  通过iframe的src属性由外域转向本地域，跨域数据即由iframe的window.name从外域传递到本地域。这个就巧妙地绕过了浏览器的跨域访问限制，但同时它又是安全操作。</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-11\"><a name=\"t14\"></a><span style=\"color:#1c1f21;\">8、postMessage跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  postMessage是HTML5 XMLHttpRequest Level 2中的API，且是为数不多可以跨域操作的window属性之一，它可用于解决以下方面的问题：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\">页面和其打开的新窗口的数据传递</span></li><li><span style=\"color:#1c1f21;\">多窗口之间消息传递</span></li><li><span style=\"color:#1c1f21;\">页面与嵌套的iframe消息传递</span></li><li><span style=\"color:#1c1f21;\">上面三个场景的跨域数据传递</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">用法：postMessage(data,origin)方法接受两个参数：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <ul style=\"margin-left:0px;\"><li><span style=\"color:#1c1f21;\"><strong>data</strong>： html5规范支持任意基本类型或可复制的对象，但部分浏览器只支持字符串，所以传参时最好用JSON.stringify()序列化。</span></li><li><span style=\"color:#1c1f21;\"><strong>origin</strong>： 协议+主机+端口号，也可以设置为\"*\"，表示可以传递给任意窗口，如果要指定和当前窗口同源的话设置为\"/\"。</span></li></ul>\n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">1）a.html：(<a href=\"http://www.domain1.com/a.html\">http://www.domain1.com/a.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"set-code-hide\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:824px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">iframe</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"iframe\"</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"http://www.domain2.com/b.html\"</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">\"display:none;\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">iframe</span>&gt;</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\">       </span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-keyword\">var</span> iframe = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">'iframe'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    iframe.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-keyword\">var</span> data = {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">'aym'</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        };</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-comment\">// 向domain2传送跨域数据</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        iframe.<span class=\"hljs-property\">contentWindow</span>.<span class=\"hljs-title function_\">postMessage</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(data), <span class=\"hljs-string\">'http://www.domain2.com'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    };</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 接受domain2返回数据</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">'message'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-title function_\">alert</span>(<span class=\"hljs-string\">'data from domain2 ---&gt; '</span> + e.<span class=\"hljs-property\">data</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }, <span class=\"hljs-literal\">false</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span><div class=\"hide-preCode-box\"><span class=\"hide-preCode-bt\" data-report-view=\"{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}\"><img class=\"look-more-preCode contentImg-no-view\" src=\"https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png\" alt=\"\" title=\"\"></span></div></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">2）b.html：(<a href=\"http://www.domain2.com/b.html\">http://www.domain2.com/b.html</a>)</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:799px\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 接收domain1的数据</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">'message'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-title function_\">alert</span>(<span class=\"hljs-string\">'data from domain1 ---&gt; '</span> + e.<span class=\"hljs-property\">data</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-keyword\">var</span> data = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(e.<span class=\"hljs-property\">data</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-keyword\">if</span> (data) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            data.<span class=\"hljs-property\">number</span> = <span class=\"hljs-number\">16</span>;</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-comment\">// 处理后再发回domain1</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">            <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">parent</span>.<span class=\"hljs-title function_\">postMessage</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(data), <span class=\"hljs-string\">'http://www.domain1.com'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        }</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    }, <span class=\"hljs-literal\">false</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h3 style=\"margin-left:0px;\" id=\"article-md-title-12\"><a name=\"t15\"></a><span style=\"color:#1c1f21;\">9、WebSocket协议跨域</span></h3> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  WebSocket protocol是HTML5一种新的协议。它实现了浏览器与服务器全双工通信，同时允许跨域通讯，是server push技术的一种很好的实现。<br> 原生WebSocket API使用起来不太方便，我们使用Socket.io，它很好地封装了webSocket接口，提供了更简单、灵活的接口，也对不支持webSocket的浏览器提供了向下兼容。<br><br> 1）前端代码：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-xml\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>user input：<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"text\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">\"https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\"></span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> socket = <span class=\"hljs-title function_\">io</span>(<span class=\"hljs-string\">'http://www.domain2.com:8080'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 连接成功处理</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">socket.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'connect'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 监听服务端消息</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    socket.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'message'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">msg</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'data from server: ---&gt; '</span> + msg); </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 监听服务端关闭</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    socket.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'disconnect'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) { </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Server socket has closed.'</span>); </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"17\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"18\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"19\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementsByTagName</span>(<span class=\"hljs-string\">'input'</span>)[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">onblur</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"20\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    socket.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">value</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"21\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">};</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"22\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span></div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">2）Nodejs socket后台：</span></p> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <pre style=\"margin-left:0px;\" class=\"\" name=\"code\"><span style=\"color:#1c1f21;\"><code class=\"hljs language-javascript\"><ol class=\"hljs-ln\" style=\"width:100%\"><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"1\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'http'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"2\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> socket = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">'socket.io'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"3\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"4\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 启http服务</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"5\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-keyword\">var</span> server = http.<span class=\"hljs-title function_\">createServer</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">req, res</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"6\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    res.<span class=\"hljs-title function_\">writeHead</span>(<span class=\"hljs-number\">200</span>, {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"7\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-string\">'Content-type'</span>: <span class=\"hljs-string\">'text/html'</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"8\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"9\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    res.<span class=\"hljs-title function_\">end</span>();</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"10\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"11\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"12\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">server.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-string\">'8080'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"13\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Server is running at port 8080...'</span>);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"14\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"15\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"><span class=\"hljs-comment\">// 监听socket连接</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"16\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">socket.<span class=\"hljs-title function_\">listen</span>(server).<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'connection'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">client</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"17\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 接收信息</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"18\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    client.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'message'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">msg</span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"19\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        client.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">'hello：'</span> + msg);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"20\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'data from client: ---&gt; '</span> + msg);</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"21\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"22\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\"> </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"23\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    <span class=\"hljs-comment\">// 断开处理</span></div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"24\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    client.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">'disconnect'</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"25\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'Client socket has closed.'</span>); </div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"26\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">    });</div></div></li><li><div class=\"hljs-ln-numbers\"><div class=\"hljs-ln-line hljs-ln-n\" data-line-number=\"27\"></div></div><div class=\"hljs-ln-code\"><div class=\"hljs-ln-line\">});</div></div></li></ol></code><div class=\"hljs-button {2}\" data-title=\"复制\" data-report-click=\"{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}\" onclick=\"hljs.copyCode(event)\"></div></span></pre> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <h2 style=\"margin-left:0px;\"><a name=\"t16\"></a><span style=\"color:#1c1f21;\">小结</span></h2> \n  </div> \n  <div style=\"margin-left:0px;\"> \n   <p style=\"margin-left:0px;\"><span style=\"color:#1c1f21;\">  以上就是9种常见的跨域解决方案，jsonp（只支持get请求，支持老的IE浏览器）适合加载不同域名的js、css，img等静态资源；CORS（支持所有类型的HTTP请求，但浏览器IE10以下不支持）适合做ajax各种跨域请求；Nginx代理跨域和nodejs中间件跨域原理都相似，都是搭建一个服务器，直接在服务器端请求HTTP接口，这适合前后端分离的前端项目调后端接口。document.domain+iframe适合主域名相同，子域名不同的跨域请求。postMessage、websocket都是HTML5新特性，兼容性不是很好，只适用于主流浏览器和IE10+。<br><br>   这么多的跨域方案，没有最好，只有最合适的，根据具体的使用场景选择跨域方案。希望这篇博文能带给大家一点帮助~~</span></p> \n  </div> \n </div> \n <div style=\"margin-left:0px;\"> \n  <div style=\"margin-left:0px;\">\n   &nbsp;\n  </div> \n </div> \n</div>\n                </div><div data-report-view=\"{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://blog.csdn.net/mydriverc2/article/details/113948017&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}\"><div></div></div>\n        </div>`\n    }\n})\n\nMock.mock(\"/api/com\", \"post\", {\n    code: 0,\n    msg: \"\",\n    data: {\n        id: \"@guid\",\n        nickName: \"@cname\",\n        content: \"@cparagraph(1 ,10)\",\n        createDate: Date.now(),\n        \"avatar|1\": [\n            \"https://avatars.devrant.com/v-37_c-3_b-5_g-m_9-1_1-2_16-3_3-2_8-1_7-1_5-1_12-2_6-2_10-1_2-10_22-1_15-3_4-1.jpg\",\n            \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-2_1-1_16-9_3-6_8-4_7-4_5-4_12-1_6-7_10-5_2-59_22-1_11-2_18-4_19-3_4-4_20-13_21-5.jpg\",\n            \"https://avatars.devrant.com/v-37_c-3_b-6_g-m_9-1_1-1_16-6_3-6_8-2_7-2_5-1_12-1_6-1_10-3_2-14_22-8_18-2_19-2_4-1_20-1.jpg\",\n            \"https://avatars.devrant.com/v-37_c-3_b-4_g-m_9-1_1-2_16-12_3-1_8-1_7-1_5-1_12-2_6-15_2-20_22-7_15-10_4-1.jpg\",\n            \"https://avatars.devrant.com/v-37_c-3_b-7_g-m_9-1_1-7_16-1_3-1_8-1_7-1_5-1_12-7_6-10_2-31_22-6_15-3_18-1_19-1_4-1.jpg\",\n            \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-1_1-6_16-1_3-1_8-1_7-1_5-1_12-6_6-10_10-1_2-3_22-6_19-1_4-1.jpg\"\n        ]\n    }\n})\n\nMock.mock(/^\\/api\\/comment\\/?(\\?.+)?$/, \"get\", function (options) {\n    const query = qs.parse(options.url);\n    return Mock.mock({\n        code: 0,\n        msg: \"\",\n        data: {\n            total: 52,\n            [`rows|${query.limit || 10 }`]: [{\n                id: \"@guid\",\n                nickName: \"@cname\",\n                content: \"@cparagraph(1 ,10)\",\n                createDate: Date.now(),\n                \"avatar|1\": [\n                    \"https://avatars.devrant.com/v-37_c-3_b-5_g-m_9-1_1-2_16-3_3-2_8-1_7-1_5-1_12-2_6-2_10-1_2-10_22-1_15-3_4-1.jpg\",\n                    \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-2_1-1_16-9_3-6_8-4_7-4_5-4_12-1_6-7_10-5_2-59_22-1_11-2_18-4_19-3_4-4_20-13_21-5.jpg\",\n                    \"https://avatars.devrant.com/v-37_c-3_b-6_g-m_9-1_1-1_16-6_3-6_8-2_7-2_5-1_12-1_6-1_10-3_2-14_22-8_18-2_19-2_4-1_20-1.jpg\",\n                    \"https://avatars.devrant.com/v-37_c-3_b-4_g-m_9-1_1-2_16-12_3-1_8-1_7-1_5-1_12-2_6-15_2-20_22-7_15-10_4-1.jpg\",\n                    \"https://avatars.devrant.com/v-37_c-3_b-7_g-m_9-1_1-7_16-1_3-1_8-1_7-1_5-1_12-7_6-10_2-31_22-6_15-3_18-1_19-1_4-1.jpg\",\n                    \"https://avatars.devrant.com/v-37_c-3_b-1_g-m_9-1_1-6_16-1_3-1_8-1_7-1_5-1_12-6_6-10_10-1_2-3_22-6_19-1_4-1.jpg\"\n                ]\n            }]\n        }\n    })\n})"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,QAAjB;AACA,OAAOC,EAAP,MAAe,IAAf,C,CACA;;AACAD,IAAI,CAACE,IAAL,CAAU,eAAV,EAA2B,KAA3B,EAAkC;EAC9BC,IAAI,EAAE,CADwB;EAE9BC,GAAG,EAAE,EAFyB;EAG9B,cAAc,CAAC;IAAE;IACb,SAAS,CADE;IACC;IACZC,IAAI,EAAE,OAFK;IAGX,sBAAsB,CAHX;IAGc;IACzB,YAAY,CAJD,CAII;;EAJJ,CAAD;AAHgB,CAAlC;AAWAL,IAAI,CAACE,IAAL,CAAU,sBAAV,EAAkC,KAAlC,EAAyC,UAAUI,OAAV,EAAmB;EACxD,IAAMC,KAAK,GAAGN,EAAE,CAACO,KAAH,CAASF,OAAO,CAACG,GAAjB,CAAd;EACA,OAAOT,IAAI,CAACE,IAAL,CAAU;IACbC,IAAI,EAAE,CADO;IAEbC,GAAG,EAAE,EAFQ;IAGbM,IAAI;MACA,mBAAmB;IADnB,kBAESH,KAAK,CAACI,KAAN,IAAe,EAFxB,GAEgC,CAAC;MAC7BC,EAAE,EAAE,OADyB;MAE7BC,KAAK,EAAE,SAFsB;MAG7BC,WAAW,EAAE,mBAHgB;MAI7BC,QAAQ,EAAE;QACN,WAAW,CADL;QAENV,IAAI,EAAE;MAFA,CAJmB;MAQ7B,oBAAoB,CARS;MAS7B,uBAAuB,CATM;MAU7B;MACA,WAAW,CAAC,yCAAD,CAXkB;MAY7BW,UAAU;IAZmB,CAAD,CAFhC;EAHS,CAAV,CAAP;AAqBH,CAvBD;AAyBAhB,IAAI,CAACE,IAAL,CAAU,sBAAV,EAAkC,KAAlC,EAAyC;EACrCC,IAAI,EAAE,CAD+B;EAErCC,GAAG,EAAE,EAFgC;EAGrCM,IAAI,EAAE;IACFE,EAAE,EAAE,OADF;IAEFC,KAAK,EAAE,eAFL;IAGFE,QAAQ,EAAE;MACN,WAAW,CADL;MAENV,IAAI,EAAE;IAFA,CAHR;IAOFS,WAAW,EAAE,oBAPX;IAQF,sBAAsB,CARpB;IASF,uBAAuB,CATrB;IAUFE,UAAU,cAVR;IAWFC,GAAG,EAAE,CAAC;MACEZ,IAAI,EAAE,OADR;MAEEa,MAAM,EAAE;IAFV,CAAD,EAID;MACIb,IAAI,EAAE,SADV;MAEIa,MAAM,EAAE;IAFZ,CAJC,EAQD;MACIb,IAAI,EAAE,UADV;MAEIa,MAAM,EAAE,oBAFZ;MAGIC,YAAY,EAAE,CAAC;QACPd,IAAI,EAAE,QADC;QAEPa,MAAM,EAAE;MAFD,CAAD,EAIV;QACIb,IAAI,EAAE,cADV;QAEIa,MAAM,EAAE;MAFZ,CAJU,EAQV;QACIb,IAAI,EAAE,WADV;QAEIa,MAAM,EAAE;MAFZ,CARU,EAYV;QACIb,IAAI,EAAE,eADV;QAEIa,MAAM,EAAE;MAFZ,CAZU,EAgBV;QACIb,IAAI,EAAE,0BADV;QAEIa,MAAM,EAAE;MAFZ,CAhBU,EAoBV;QACIb,IAAI,EAAE,wBADV;QAEIa,MAAM,EAAE;MAFZ,CApBU,EAwBV;QACIb,IAAI,EAAE,sBADV;QAEIa,MAAM,EAAE;MAFZ,CAxBU,EA4BV;QACIb,IAAI,EAAE,eADV;QAEIa,MAAM,EAAE;MAFZ,CA5BU,EAgCV;QACIb,IAAI,EAAE,eADV;QAEIa,MAAM,EAAE;MAFZ,CAhCU;IAHlB,CARC,CAXH;IA8DF,WAAW,CAAClB,IAAI,CAACoB,MAAL,CAAYC,KAAZ,CAAkB,SAAlB,EAA6B,MAA7B,EAAqC,MAArC,EAA6C,cAA7C,CAAD,EAA+D,IAA/D,CA9DT;IA+DFC,WAAW;EA/DT;AAH+B,CAAzC;AA4YAtB,IAAI,CAACE,IAAL,CAAU,UAAV,EAAsB,MAAtB,EAA8B;EAC1BC,IAAI,EAAE,CADoB;EAE1BC,GAAG,EAAE,EAFqB;EAG1BM,IAAI,EAAE;IACFE,EAAE,EAAE,OADF;IAEFW,QAAQ,EAAE,QAFR;IAGFC,OAAO,EAAE,oBAHP;IAIFR,UAAU,EAAES,IAAI,CAACC,GAAL,EAJV;IAKF,YAAY,CACR,gHADQ,EAER,qIAFQ,EAGR,0HAHQ,EAIR,8GAJQ,EAKR,sHALQ,EAMR,gHANQ;EALV;AAHoB,CAA9B;AAmBA1B,IAAI,CAACE,IAAL,CAAU,4BAAV,EAAwC,KAAxC,EAA+C,UAAUI,OAAV,EAAmB;EAC9D,IAAMC,KAAK,GAAGN,EAAE,CAACO,KAAH,CAASF,OAAO,CAACG,GAAjB,CAAd;EACA,OAAOT,IAAI,CAACE,IAAL,CAAU;IACbC,IAAI,EAAE,CADO;IAEbC,GAAG,EAAE,EAFQ;IAGbM,IAAI;MACAiB,KAAK,EAAE;IADP,kBAESpB,KAAK,CAACI,KAAN,IAAe,EAFxB,GAEgC,CAAC;MAC7BC,EAAE,EAAE,OADyB;MAE7BW,QAAQ,EAAE,QAFmB;MAG7BC,OAAO,EAAE,oBAHoB;MAI7BR,UAAU,EAAES,IAAI,CAACC,GAAL,EAJiB;MAK7B,YAAY,CACR,gHADQ,EAER,qIAFQ,EAGR,0HAHQ,EAIR,8GAJQ,EAKR,sHALQ,EAMR,gHANQ;IALiB,CAAD,CAFhC;EAHS,CAAV,CAAP;AAqBH,CAvBD"},"metadata":{},"sourceType":"module"}